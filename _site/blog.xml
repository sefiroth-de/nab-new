<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Norman&#39;s Academic Blog</title>
<link>https://www.sefiroth.de/blog.html</link>
<atom:link href="https://www.sefiroth.de/blog.xml" rel="self" type="application/rss+xml"/>
<description>Norman&#39;s Academic Blog</description>
<generator>quarto-1.7.32</generator>
<lastBuildDate>Sat, 26 Jul 2025 22:00:00 GMT</lastBuildDate>
<item>
  <title>Beweisverfahren in der Mathematik</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2025-07-27-Beweisverfahren/</link>
  <description><![CDATA[ 





<section id="allgemeine-beweistechniken" class="level2">
<h2 class="anchored" data-anchor-id="allgemeine-beweistechniken">Allgemeine Beweistechniken</h2>
<section id="beweis-durch-einschüchterung" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-einschüchterung">Beweis durch Einschüchterung</h3>
<p>Trivial!</p>
</section>
<section id="beweis-durch-umständliche-notation" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-umständliche-notation">Beweis durch umständliche Notation</h3>
<p>Der Satz folgt sofort aus dem Fakt</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Cleft%7C%0A%20%20%20%20%5Coplus_%7Bk%20%5Cin%20S%7D%0A%20%20%20%20%20%20%5Cleft(%0A%20%20%20%20%20%20%20%5Cmathfrak%7BK%7D%5E%7B%5Cmathbb%7BF%7D%5E%5Calpha(i)%7D%20%20%0A%20%20%20%20%20%20%5Cright)_%7Bi%20%5Cin%20%5Cmathcal%7BU%7D_k%7D%0A%20%20%5Cright%7C%0A%20%20%5Cpreceq%20%5Caleph_1%0A%20%20%5Ctext%7B%20wenn%20%7D%0A%20%20%5Cleft%5B%0A%20%20%20%20%5Cmathfrak%7BH%7D_%5Cmathcal%7BW%7D%0A%20%20%5Cright%5D%20%20%20%20%20%0A%20%20%5Ccap%20%5Cmathbb%7BF%7D%5E%5Calpha(%5Cmathbb%7BN%7D)%20%5Cneq%20%5Cemptyset.%0A"></p>
</section>
<section id="beweis-durch-unzugreifbare-literatur" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-unzugreifbare-literatur">Beweis durch unzugreifbare Literatur</h3>
<p>Der Satz ist ein einfaches Korrollat eines Ergebnis bewiesen in einer handgeschriebenen Anmerkung ausgehändigt in einer Vorlesun bei der Jugoslawischen Mathematischen Gesellschaft 1973.</p>
</section>
<section id="beweis-durch-geisterhafte-zitate" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-geisterhafte-zitate">Beweis durch geisterhafte Zitate</h3>
<p>Der Beweis kann auf Seite 478 gefunden werden, in einem Buch, welches nur 396 Seiten hat.</p>
</section>
<section id="beweis-durch-circularer-argumentation" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-circularer-argumentation">Beweis durch circularer Argumentation</h3>
<p>Proposition 5.18 in [BL] ist ein einfaches Korollar zm Satz 7.18 in [C], welches wiederum auf Korollar 2.14 in [K] basiert. Dieses wiederum wird unter Bezugnahme auf Proposition 5.18 in [BL] hergeleitet.</p>
</section>
<section id="beweis-durch-autorität" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-autorität">Beweis durch Autorität</h3>
<p>Mein guter Kollege Andrew meinte, er glaube, er hätte dafür vor ein paar Jahren einen Beweis finden können …</p>
</section>
<section id="beweis-durch-internet-referenz" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-internet-referenz">Beweis durch Internet Referenz</h3>
<p>Für Interessierte ist das Ergebnis auf der Webseite zu diesem Buch zu sehen. – Die es leider nicht mehr gibt.</p>
</section>
<section id="beweis-durch-vermeidung" class="level3">
<h3 class="anchored" data-anchor-id="beweis-durch-vermeidung">Beweis durch Vermeidung</h3>
<p>Kapitel 3: Der Beweis hierfür wird erst in Kapitel 7 erbracht, wenn wir die Theorie weiterentwickelt haben.</p>
<p>Kapitel 7: Der Einfachheit halber beweisen wir dies nur für den Fall z = 0. Der allgemeine Fall wird jedoch in Anhang C behandelt.</p>
<p>Anhang C: Der formale Beweis geht über den Rahmen dieses Buches hinaus, aber unsere Intuition sagt uns natürlich, dass dies wahr ist.</p>


</section>
</section>

 ]]></description>
  <category>Mathematik</category>
  <guid>https://www.sefiroth.de/posts/2025-07-27-Beweisverfahren/</guid>
  <pubDate>Sat, 26 Jul 2025 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Willkommen in meinem Blog</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/Willkommen/</link>
  <description><![CDATA[ 





<p>Das ist mein erster Blog-Eintrag! Ich werde nun hoffentlich (langsam) meinen Blog von Hugo aus Quarto umstellen. Ich arbeite viel mit R und eine extra Sprache nur für den Blog ist mir einfach auf Dauer zu umständlich. Aber mal sehen, wann ich Zeit finde dieses Projekt umzustezen.</p>



 ]]></description>
  <category>news</category>
  <guid>https://www.sefiroth.de/posts/Willkommen/</guid>
  <pubDate>Fri, 18 Jul 2025 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Grafiken nebeneinander setzen mit ggplot2 oder ggformula</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-12-27-grafiken-nebeneinander-setzen-mit-ggplot2-oder-ggformula/</link>
  <description><![CDATA[ 





<section id="wie-menschen-grafiken-von-ggplot2-oder-ggformula-nebeneinander-setzten-kann" class="level2">
<h2 class="anchored" data-anchor-id="wie-menschen-grafiken-von-ggplot2-oder-ggformula-nebeneinander-setzten-kann">Wie menschen Grafiken von ggplot2 oder ggformula nebeneinander setzten kann</h2>
<p>Ab und zu möchte mensch zwei (oder mehr) Grafiken neben- oder übereinander setzen.</p>
<p>Hier ein kurzes Beispiel, wie das gelingen kann. Zunächst bereiten wir alles vor, in dem wir die Pakete laden und die Daten freigeben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggf. einmal vorher den Befehl:</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("gridExtra")</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ausführen oder das Paket "gridExtra" installieren.</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gridExtra)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(iris)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Datensatz bereitstellen</span></span></code></pre></div>
</div>
<p>Dann erstellen nun vier Plots und speichern diese in vier Variablen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ersten Plot erstellen</span></span>
<span id="cb2-2">plot1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(Sepal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Sepal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zweiten Plot erstellen</span></span>
<span id="cb2-5">plot2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(Petal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Petal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dritten Plot erstellen</span></span>
<span id="cb2-8">plot3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(Sepal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Petal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris)</span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vierten Plot erstellen</span></span>
<span id="cb2-11">plot4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(Petal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Sepal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> iris)</span></code></pre></div>
</div>
<p>Nun arrangieren wir die Plots entsprechend:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zwei Plots nebeneinander in einer Zeile: </span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.arrange</span>(plot1, plot2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-12-27-grafiken-nebeneinander-setzen-mit-ggplot2-oder-ggformula/index_files/figure-html/unnamed-chunk-4-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zwei Plots untereinander in einer Spalte</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.arrange</span>(plot1, plot2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-12-27-grafiken-nebeneinander-setzen-mit-ggplot2-oder-ggformula/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vier Plots in einer Matrix:</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid.arrange</span>(plot1, plot2, plot3, plot4, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-12-27-grafiken-nebeneinander-setzen-mit-ggplot2-oder-ggformula/index_files/figure-html/unnamed-chunk-6-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-12-27-grafiken-nebeneinander-setzen-mit-ggplot2-oder-ggformula/</guid>
  <pubDate>Sun, 26 Dec 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>CSV Dateien bearbeiten mit Miller</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/csv-dateien-bearbeiten-mit-miller/</link>
  <description><![CDATA[ 





<p>Miller beschreibt sich selbst folgendermaßen:</p>
<blockquote class="blockquote">
<p>Miller is like awk, sed, cut, join, and sort for name-indexed data such as CSV, TSV, and tabular JSON. You get to work with your data using named fields, without needing to count positional column indices.</p>
</blockquote>
<p>Miller kombiniert die Funktionalität von awk, sed und cut und eignet sich besonders für feldbasierte Datenmanipulation.</p>
<section id="beispiel-1-erstellung-einer-markdown-tabelle" class="level3">
<h3 class="anchored" data-anchor-id="beispiel-1-erstellung-einer-markdown-tabelle">Beispiel 1: Erstellung einer Markdown-Tabelle</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> mlr <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--icsv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--fs</span> semicolon <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--otsv</span> cat tips.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/,/./g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlr</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--itsv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--omd</span> cat</span></code></pre></div>
<p>Mit diesem Befehl wird eine durch Semikolon getrennte CSV-Datei in eine durch Tabulator getrennte TSV-Datei umgewandelt, anschließend werden alle Kommata durch Punkte ersetzt und schließlich wird daraus eine Markdown-Tabelle erzeugt.</p>
</section>
<section id="beispiel-2-gerahmte-darstellung" class="level3">
<h3 class="anchored" data-anchor-id="beispiel-2-gerahmte-darstellung">Beispiel 2: Gerahmte Darstellung</h3>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> mlr <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">--icsv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--fs</span> semicolon <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--otsv</span> cat tips.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/,/./g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mlr</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--itsv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--opprint</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--barred</span> cat</span></code></pre></div>
<p>Mit diesem Befehl wird ebenfalls eine durch Semikolon getrennte CSV-Datei in eine durch Tabulator getrennte TSV-Datei umgewandelt, alle Kommata werden durch Punkte ersetzt und am Ende wird eine eingerahmte Tabelle erzeugt.</p>


</section>

 ]]></description>
  <category>Allgemeines</category>
  <category>Miller</category>
  <category>CSV</category>
  <category>Datenjudo</category>
  <category>Datenformate</category>
  <guid>https://www.sefiroth.de/posts/csv-dateien-bearbeiten-mit-miller/</guid>
  <pubDate>Thu, 26 Aug 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Datenjudo für Fragebögen</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/</link>
  <description><![CDATA[ 





<p>Ab und zu bekomme ich die Frage, wie man einen Fragebogen mit Likert-Scalen-Items auswerten kann.</p>
<p>Dazu kann etwas gezieltes Datenjudo helfen. Wir schauen uns das folgende generierte Mini-Beispiel an:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basis Paket</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Eine modernere Variante der data.frames!</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2009</span>)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reproduzierbarkeit</span></span>
<span id="cb1-4"></span>
<span id="cb1-5">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Anzahl der Testzeileneinträge in den "testdaten"!</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir wollen eine Likert-Scale </span></span>
<span id="cb1-8">minLikert <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bis</span></span>
<span id="cb1-9">maxLikert <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># erstellen.</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zum späteren Umrechnen der inversen Items:</span></span>
<span id="cb1-12">maxInvItem <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> maxLikert <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir bauen uns eine Testumfrage mit zwei Itemserien </span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (AS1-AS6 und BS1-BS6) und N Beobachtungen.</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Die Items AS3, AS4  und BS1 und BS5 sind dabei </span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inverse Items, welche später umgerechnet werden:</span></span>
<span id="cb1-18">testdaten <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ID =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>N,</span>
<span id="cb1-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AS1-AS6 bilden ein Itemset:</span></span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS5 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS6 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BS1-BS5 bilden ein Itemset:</span></span>
<span id="cb1-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS5 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(minLikert<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>maxLikert, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb1-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Geschlecht als sex mit (1 für Frauen und 2 für Männer)</span></span>
<span id="cb1-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, N, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">replace =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-35">)</span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Orinal testdaten einmal ausgeben:</span></span>
<span id="cb1-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(testdaten)</span>
<span id="cb1-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; # A tibble: 6 × 13</span></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      ID   AS1   AS2   AS3   AS4   AS5   AS6   BS1   BS2   BS3   BS4   BS5   sex</span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1     1     4     4     1     1     2     4     5     5     3     2     3     2</span></span>
<span id="cb1-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2     2     2     1     2     2     5     6     4     5     2     2     6     1</span></span>
<span id="cb1-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 3     3     4     4     6     3     3     4     3     3     4     1     5     1</span></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 4     4     2     6     1     4     5     4     6     4     5     1     3     1</span></span>
<span id="cb1-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 5     5     3     1     3     5     5     6     6     1     2     6     5     1</span></span>
<span id="cb1-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 6     6     6     4     1     3     6     6     4     6     5     3     3     1</span></span></code></pre></div>
</div>
<p>Die Spalten AS3, AS4 und BS1, BS5 waren inverse Items, die wir noch umrechnen müssen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inverse Item umrechnen:</span></span>
<span id="cb2-2">testdaten <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS3 =</span> maxInvItem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> AS3,</span>
<span id="cb2-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS4 =</span> maxInvItem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> AS4,</span>
<span id="cb2-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS1 =</span> maxInvItem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> BS1,</span>
<span id="cb2-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS5 =</span> maxInvItem <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> BS5</span>
<span id="cb2-8">    ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> testdaten_korrigiert </span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Die Daten mit den umgerechnetern inversen Items:</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(testdaten_korrigiert)</span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; # A tibble: 6 × 13</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      ID   AS1   AS2   AS3   AS4   AS5   AS6   BS1   BS2   BS3   BS4   BS5   sex</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1     1     4     4     6     6     2     4     2     5     3     2     4     2</span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2     2     2     1     5     5     5     6     3     5     2     2     1     1</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 3     3     4     4     1     4     3     4     4     3     4     1     2     1</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 4     4     2     6     6     3     5     4     1     4     5     1     4     1</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 5     5     3     1     4     2     5     6     1     1     2     6     2     1</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 6     6     6     4     6     4     6     6     3     6     5     3     4     1</span></span></code></pre></div>
</div>
<p>Die jeweiligen Itemsets werden nun zur einem Wert (Gesamtscore) zusammengefasst, in dem wir jeweils den Mittelwert von <code>AS1</code>-<code>AS6</code> und <code>BS1</code>-<code>BS5</code> bildenund in <code>AS</code> bzw. <code>BS</code> speichern:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir fassen nun die AS1-AS6 und die BS1-BS5 zusammen </span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># und bilden die jeweiligen Mittelwerte:</span></span>
<span id="cb3-3">testdaten_korrigiert <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(ID, sex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Damit wird für jede Zeile die Zusammenfassung gemacht!</span></span>
<span id="cb3-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">AS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(AS1, AS2, AS3, AS4, AS5, AS6)),</span>
<span id="cb3-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BS =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(BS1, BS2, BS3, BS4, BS5))</span>
<span id="cb3-8">    ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> testdaten_sum</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ausgabe der Mittelwerte der AS und BS</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(testdaten_sum)</span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; # A tibble: 6 × 4</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; # Groups:   ID [6]</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      ID   sex    AS    BS</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1     1     2  4.33   3.2</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2     2     1  4      2.6</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 3     3     1  3.33   2.8</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 4     4     1  4.33   3  </span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 5     5     1  3.5    2.4</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 6     6     1  5.33   4.2</span></span></code></pre></div>
</div>
<p>Die Datentabelle <code>testdaten_sum</code> enthält nun die Spalten <code>AS</code> und <code>BS</code> mit den entsprechenden Mittelwerten der einzelnen Items <code>AS1</code>-<code>AS6</code> sowieso <code>BS1</code>- <code>BS5</code>.</p>
<p>Wir wollen nun die Ergebnisse als Boxplots anzeigen lassen. Dafür benennen wir die Geschlechter von 1,2 auf “Frau”, “Mann” um:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">testdaten_sum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sex =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-3">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frau"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mann"</span>))</span>
<span id="cb4-4">    ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> testdaten_sex </span></code></pre></div>
</div>
<p>Nun können wir die Boxplots erstellen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Darstellung der Ergebnisse als Boxplot AS ~ sex:</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_boxplot</span>(AS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> testdaten_sex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_labs</span>(</span>
<span id="cb5-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot von AS nach Geschlechtern"</span>,</span>
<span id="cb5-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geschlechter"</span>,</span>
<span id="cb5-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Item AS"</span></span>
<span id="cb5-7">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb5-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb5-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb5-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gibt den Bereich von 2.5 bis 4.5 aus!</span></span>
<span id="cb5-13">    )  </span>
<span id="cb5-14">  )</span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Darstellung der Ergebnisse als Boxplot BS ~ sex:</span></span>
<span id="cb5-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_boxplot</span>(BS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> testdaten_sex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_labs</span>(</span>
<span id="cb5-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Boxplot von BS nach Geschlechtern"</span>,</span>
<span id="cb5-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geschlechter"</span>,</span>
<span id="cb5-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Item BS"</span></span>
<span id="cb5-22">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb5-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb5-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb5-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gibt den ganzen Bereich von 1 bis 6 aus!</span></span>
<span id="cb5-28">    )  </span>
<span id="cb5-29">  )</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-5-2.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Die Kennzahlen dazu erhalten wir mit <code>favstats</code>. Dabei wählen wir die ersten sechs Einträge (Variabelbezeichnung und Q0 bis Q4) aus:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(AS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> testdaten_sex)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    sex      min       Q1   median       Q3      max</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1 Frau 2.166667 3.333333 3.666667 4.166667 5.333333</span></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 Mann 3.666667 4.000000 4.333333 4.333333 4.500000</span></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(BS <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> sex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> testdaten_sex)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    sex min  Q1 median  Q3 max</span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1 Frau 2.4 2.8    3.4 4.2 4.6</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 Mann 2.6 3.2    3.3 3.8 4.2</span></span></code></pre></div>
</div>
<p>Unter der Verwendung des Pakets <code>likert</code> (https://github.com/jbryer/likert) können wir die Ausgaben auch noch etwas schöner gestalten:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(likert)</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir wählen nur den Itemset BS aus und speichern in in items2:</span></span>
<span id="cb7-4">testdaten_korrigiert <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(</span>
<span id="cb7-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BS"</span>)</span>
<span id="cb7-7">  ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> items2</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Leider mag likert tibbels nicht so gerne, daher:</span></span>
<span id="cb7-10">items2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(items2)</span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir geben den Items noch ein paar Buzzwords:</span></span>
<span id="cb7-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(items2) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gesundheit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Familie"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Geld"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Freunde"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Langes Leben"</span>)</span>
<span id="cb7-14"></span>
<span id="cb7-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vorbereitung:</span></span>
<span id="cb7-16">l2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">likert</span>(items2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nlevels =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-17"></span>
<span id="cb7-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zusammenfassung</span></span>
<span id="cb7-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(l2)</span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;           Item      low   neutral     high     mean       sd</span></span>
<span id="cb7-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 3         Geld 28.57143 23.809524 47.61905 3.380952 1.359272</span></span>
<span id="cb7-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 5 Langes Leben 57.14286  4.761905 38.09524 2.619048 1.532194</span></span>
<span id="cb7-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1   Gesundheit 38.09524 28.571429 33.33333 2.857143 1.492840</span></span>
<span id="cb7-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2      Familie 38.09524 28.571429 33.33333 2.952381 1.499206</span></span>
<span id="cb7-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 4      Freunde 42.85714 23.809524 33.33333 2.857143 1.236354</span></span>
<span id="cb7-26"></span>
<span id="cb7-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Graphische Ausgaben:</span></span>
<span id="cb7-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l2)</span>
<span id="cb7-29"></span>
<span id="cb7-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l2,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bar"</span>)</span>
<span id="cb7-31"></span>
<span id="cb7-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l2,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"heat"</span>)</span>
<span id="cb7-33"></span>
<span id="cb7-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(l2,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"density"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-7-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-7-2.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-7-3.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/index_files/figure-html/unnamed-chunk-7-4.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Voilà!</p>



 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-27-datenjudo-fuer-frageboegen/</guid>
  <pubDate>Sat, 26 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Dinge die man in zwei Dimensionen machen kann - Multiple lineare Regression</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-24-dinge-die-man-in-zwei-dimensionen-machen-kann-multiple-lineare-regression/</link>
  <description><![CDATA[ 





<p>Wir wollen den Fall unterschen bei dem wir mit zwei statistischen Variabeln (<img src="https://latex.codecogs.com/png.latex?X"> und <img src="https://latex.codecogs.com/png.latex?Y">) eine dritte Variable (<img src="https://latex.codecogs.com/png.latex?Z">) mittels einer multiplen linearen Regression modellieren.</p>
<p>Es seien die Datenpunkte <img src="https://latex.codecogs.com/png.latex?(x_1,%20y_1,%20z_1),%20%5Cdots,%20(x_n,%20y_n,%20z_n)"> gegeben und wir wollen eine lineare Funktion <img src="https://latex.codecogs.com/png.latex?g(x,y)"> finden, so dass</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az_i%20=%20g(x_i,y_i)+%20%5Cepsilon_i%20=%5Cbeta_0%20+%20%5Cbeta_1%20%5Ccdot%20x_i%20+%20%5Cbeta_2%20%5Ccdot%20y_i%20+%20%5Cepsilon_i%0A"></p>
<p>gilt und der Abweichungsterm <img src="https://latex.codecogs.com/png.latex?%5Cepsilon_i"> möglichst klein ist.</p>
<p>Auf Grundlage unserer Datenpunkt wollen wir die Koeffizienten so schätzen, dass die Summe der quadratische Abweichungen minimal ist. <img src="https://latex.codecogs.com/png.latex?%0A%20%20QS%20=%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)%0A%20%20=%20%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i%20-%20%5Chat%5Cbeta_0%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20y_i%20)%5E2%0A"></p>
<p>Das führt zu der folgenden, notwendigen Bedingen (für stationäre Punkte):</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnabla%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)%20=%20%5Cbegin%7Bpmatrix%7D%200%5C%5C%200%5C%5C%200%5Cend%7Bpmatrix%7D%0A"></p>
<p>Im einzelnen heißt das:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_0%7D%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)%20&amp;=%20-2%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(z_i%20-%20%5Chat%5Cbeta_0%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20y_i%20%5Cright)%20%5C%5C%0A&amp;=%20-2%20%5Ccdot%20n%20%5Ccdot%20%5Cleft(%5Cbar%7Bz%7D%20-%20%5Chat%5Cbeta_0%20-%20%5Chat%5Cbeta_1%20%5Ccdot%5Cbar%7Bx%7D%20-%20%5Chat%5Cbeta_2%20%5Ccdot%5Cbar%7By%7D%20%5Cright)%20%5C%5C%0A%5C%5C%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)%20&amp;=%20-2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%20z_i%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_0%20%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20y_i%5Ccdot%20x_i%20%5Cright)%20%5C%5C%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20z_i%5Ccdot%20x_i%20-%20%20%5Chat%5Cbeta_0%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5E2%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%5Ccdot%20x_i%20%5Cright)%20%5C%5C%0A%5C%5C%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_2%7D%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1,%20%5Chat%5Cbeta_2)%20&amp;=%20-2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%20z_i%5Ccdot%20y_i%20-%20%5Chat%5Cbeta_0%20%5Ccdot%20y_i%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%5Ccdot%20y_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20y_i%5Ccdot%20y_i%20%5Cright)%20%5C%5C%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20z_i%5Ccdot%20y_i%20-%20%20%5Chat%5Cbeta_0%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7By%7D-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5Ccdot%20y_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%5E2%20%5Cright)%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>Wir setzen die 1. Gleichung gleich Null und stellen nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> um:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Chat%5Cbeta_0%20=%20%5Cbar%7Bz%7D%20%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Cbar%7By%7D%0A"> Nun ersetzen wir <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> in den verbleibenden Gleichungen durch <img src="https://latex.codecogs.com/png.latex?z_i%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20y_i"> und nutzen den Verschiebesatz:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20QS%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20z_i%5Ccdot%20x_i%20-%20(%5Cbar%7Bz%7D%20%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Cbar%7By%7D)%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5E2%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%5Ccdot%20x_i%20%5Cright)%20%5C%5C%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(x_i%20-%20%5Cbar%7Bx%7D)%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i%20-%5Cbar%7Bx%7D)%5E2%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i-%20%5Cbar%7Bx%7D)%20%5Cright)%20%5C%5C%0A%5C%5C%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_2%7D%20QS%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20z_i%5Ccdot%20y_i%20-%20(%5Cbar%7Bz%7D%20%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Cbar%7By%7D)%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7By%7D-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5Ccdot%20y_i%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%5E2%20%5Cright)%20%5C%5C%0A&amp;=%20-2%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(y_i%20-%20%5Cbar%7By%7D)%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i%20-%5Cbar%7By%7D)%5E2%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i-%20%5Cbar%7Bx%7D)%20%5Cright)%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>Wir setzen die beiden Gleichungen nun gleich Null und formen nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_2"> um:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%5Cbeta_1%0A%20%20&amp;=%20%5Cfrac%7B%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(x_i%20-%20%5Cbar%7Bx%7D)%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i-%20%5Cbar%7Bx%7D)%7D%7B%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i%20-%5Cbar%7Bx%7D)%5E2%7D%20%5C%5C%0A%20%20%5C%5C%0A%20%20%5Chat%5Cbeta_2%0A%20%20&amp;=%20%5Cfrac%7B%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(y_i%20-%20%5Cbar%7By%7D)%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i-%20%5Cbar%7Bx%7D)%7D%7B%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i%20-%5Cbar%7By%7D)%5E2%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Durch Erweiterung von Zähler nun Nenner mit <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bn-1%7D"> erhalten wir:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%5Cbeta_1%0A%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(x_i%20-%20%5Cbar%7Bx%7D)%20-%20%5Chat%5Cbeta_2%20%5Ccdot%20%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i-%20%5Cbar%7Bx%7D)%7D%7B%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i%20-%5Cbar%7Bx%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D-%5Chat%5Cbeta_2%5Ccdot%20s_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%20=%20%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D-%5Chat%5Cbeta_2%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%20%5C%5C%0A%20%20%5C%5C%0A%20%20%5Chat%5Cbeta_2%0A%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(z_i-%5Cbar%7Bz%7D)(y_i%20-%20%5Cbar%7By%7D)%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i-%5Cbar%7By%7D)(x_i%20-%20%5Cbar%7Bx%7D)%7D%7B%5Cfrac%7B1%7D%7Bn-1%7D%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(y_i%20-%5Cbar%7By%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D-%5Chat%5Cbeta_1%5Ccdot%20s_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%20=%20%5Cfrac%7Bs_%7By,z%7D%7D%7Bs%5E2_y%7D-%5Chat%5Cbeta_1%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>wir setzen nun die erste in die zweite Gleichung ein und erhalten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_2%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D%7D%7Bs%5E2_y%7D%20-%20%5Cleft(%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D-%5Chat%5Cbeta_2%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%5Cright)%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D%7D%7Bs%5E2_y%7D%20-%20%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%20+%20%5Chat%5Cbeta_2%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7Bs_%7By,z%7D%7D%7Bs%5E2_y%7D%20-%20%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%7D%7B1-%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7By%7D%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7Bs_%7By,z%7D%5Ccdot%20s%5E2_x%20-%20s_%7Bx,z%7D%20s_%7Bx,y%7D%7D%7Bs%5E2_x%5Ccdot%20s%5E2_y%7D%7D%7B%5Cfrac%7Bs%5E2_x%20s%5E2_y-(s_%7Bx,y%7D)%5E2%7D%7Bs%5E2_x%20%5Ccdot%20s%5E2_y%7D%7D%0A%20%20=%20%5Cfrac%7Bs_%7By,z%7D%5Ccdot%20s%5E2_x%20-%20s_%7Bx,z%7D%20s_%7Bx,y%7D%7D%7Bs%5E2_x%20s%5E2_y-(s_%7Bx,y%7D)%5E2%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Und damit weiter:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_1%20%20%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D-%5Chat%5Cbeta_2%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%7D%7Bs%5E2_x%7D%20-%20%5Cfrac%7Bs_%7By,z%7D%5Ccdot%20s%5E2_x%20-%20s_%7Bx,z%7D%20s_%7Bx,y%7D%7D%7Bs%5E2_x%20s%5E2_y-(s_%7Bx,y%7D)%5E2%7D%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%20(s%5E2_x%20s%5E2_y%20-%20(s_%7Bx,y%7D)%5E2)%20-%20s_%7By,z%7Ds_%7Bx,y%7Ds%5E2_x%20+%20s_%7Bx,z%7Ds_%7Bx,y%7Ds_%7Bx,y%7D%7D%7Bs%5E2_x%20(s%5E2_x%20s%5E2_y%20-%20(s_%7Bx,y%7D)%5E2)%7D%20%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7Ds%5E2_x%20s%5E2_y%20-%20s_%7Bx,z%7D(s_%7Bx,y%7D)%5E2%20-%20s_%7By,z%7Ds_%7Bx,y%7Ds%5E2_x%20+%20s_%7Bx,z%7D(s_%7Bx,y%7D)%5E2%7D%7Bs%5E2_x%20s%5E2_x%20s%5E2_y-%20s%5E2_x(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2"></span>
<span id="cb1-3">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(mpg, hp, wt) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> dt</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Von R berechnete Koeffizienten:</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt))</span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)          hp          wt </span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 37.22727012 -0.03177295 -3.87783074</span></span>
<span id="cb1-10"></span>
<span id="cb1-11">mean_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-12">mean_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-13">mean_z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-14"></span>
<span id="cb1-15">s_xy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-16">s_xz <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-17">s_yz <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(wt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-18"></span>
<span id="cb1-19">var_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-20">var_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> wt, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-21">b1z <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s_xz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_xz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(s_xy)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_yz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s_xy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> s_xz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s_xy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-22">b1n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> var_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s_xy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-23">b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> b1z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> b1n</span>
<span id="cb1-24">b2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (s_yz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>var_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_xz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s_xy) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (var_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> var_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> s_xy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>s_xy)</span>
<span id="cb1-25">b0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mean_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mean_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mean_y</span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Koeffizienten zur Ausgabe aufbereiten:</span></span>
<span id="cb1-28">my_coef <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(b0, b1, b2)</span>
<span id="cb1-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(my_coef) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(Intercept)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hp"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wt"</span>)</span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Von Hand berechnete Koeffizienten:</span></span>
<span id="cb1-32">my_coef</span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)          hp          wt </span></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 37.22727012 -0.03177295 -3.87783074</span></span></code></pre></div>
</div>
<section id="was-passiert-wenn-wir-alle-datenpunkte-studentisieren" class="level2">
<h2 class="anchored" data-anchor-id="was-passiert-wenn-wir-alle-datenpunkte-studentisieren">Was passiert, wenn wir alle Datenpunkte studentisieren?</h2>
<p>Wir rechnen um in:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_i%5E%7B%5Ctext%7Bstud%7D%7D%20=%20%5Cfrac%7Bx_i-%5Cbar%7Bx%7D%7D%7Bs_x%7D;%20%5Cquad%20y_i%5E%7B%5Ctext%7Bstud%7D%7D%20=%20%5Cfrac%7By_i-%5Cbar%7By%7D%7D%7Bs_y%7D;%20%5Cquad%20z_i%5E%7B%5Ctext%7Bstud%7D%7D%20=%20%5Cfrac%7Bz_i-%5Cbar%7Bz%7D%7D%7Bs_z%7D%0A"></p>
<p>Damit ist</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx_i%7D%5E%5Ctext%7Bstud%7D%20=%200;%20%5Cquad%20%5Cbar%7By_i%7D%5E%5Ctext%7Bstud%7D%20=%200;%5Cquad%20%5Cbar%7Bz_i%7D%5E%5Ctext%7Bstud%7D%20=%200%0A"> und</p>
<p><img src="https://latex.codecogs.com/png.latex?%0As_%7B%7Bx_i%7D%5E%5Ctext%7Bstud%7D%7D%20=%201;%20%5Cquad%20s_%7B%7By_i%7D%5E%5Ctext%7Bstud%7D%7D%20=%201;%5Cquad%20s_%7B%7Bz_i%7D%5E%5Ctext%7Bstud%7D%7D%20=%201%0A"></p>
<p>Zur Vereinfachung lassen wir die Kennzeichnung “stud” weg. Damit ist dann:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_0%0A%20%20&amp;=%200%5C%5C%0A%5C%5C%0A%5Chat%5Cbeta_1%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%20%5Ccdot%20s%5E2_x%20%5Ccdot%20s%5E2_y%20-%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%20-%20s_%7By,z%7D%20%5Ccdot%20s_%7Bx,y%7Ds%5E2_x%20+%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%7D%7Bs%5E2_x%20%5Ccdot%20s%5E2_x%20s%5E2_y-%20s%5E2_x%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%20%5Ccdot%201%20%5Ccdot%201%20-%20%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%20-%20s_%7By,z%7D%20%5Ccdot%20s_%7Bx,y%7D%20%5Ccdot%201%20+%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%7D%7B1%20%5Ccdot%201%20%5Ccdot%201%20-%201%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%7D%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%20-%20%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%20-%20s_%7By,z%7D%20%5Ccdot%20s_%7Bx,y%7D%20+%20s_%7Bx,z%7D%20%5Ccdot%20(s_%7Bx,y%7D)%5E2%7D%7B1%20-%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,z%7D%20-%20s_%7By,z%7D%20%5Ccdot%20s_%7Bx,y%7D%20%7D%7B1%20-%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%5C%5C%0A%5Chat%5Cbeta_2%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D%20%5Ccdot%20s%5E2_x%20-%20s_%7Bx,z%7D%20%5Ccdot%20s_%7Bx,y%7D%7D%7Bs%5E2_x%20%5Ccdot%20s%5E2_y%20-%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D%20%5Ccdot%201%20-%20s_%7Bx,z%7D%20%5Ccdot%20s_%7Bx,y%7D%7D%7B1%20%5Ccdot%201%20-%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bs_%7By,z%7D%20-%20s_%7Bx,z%7D%20%5Ccdot%20s_%7Bx,y%7D%7D%7B1%20-%20(s_%7Bx,y%7D)%5E2%7D%20%5C%5C%0A%5Cend%7Baligned%7D%0A"></p>
<p>Wir schauen uns ein paar Fälle genauer an:</p>
<ol type="1">
<li><p>Fall: <img src="https://latex.codecogs.com/png.latex?X"> und <img src="https://latex.codecogs.com/png.latex?Y"> sind unabhängig. Dann ist <img src="https://latex.codecogs.com/png.latex?s_%7Bx,y%7D=0"> und wir erhalten <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1=s_%7Bx,z%7D%5Cin%5B-1;1%5D"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_2=s_%7By,z%7D%5Cin%5B-1;1%5D">.</p></li>
<li><p>Fall: <img src="https://latex.codecogs.com/png.latex?X"> und <img src="https://latex.codecogs.com/png.latex?Y"> sind abhängig. Dann ist <img src="https://latex.codecogs.com/png.latex?%7Cs_%7Bx,y%7D%7C=1"> und es gibt keine Lösung für <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_2">.</p></li>
<li><p>Fall: <img src="https://latex.codecogs.com/png.latex?0%20%3C%20%7Cs_%7Bx,y%7D%7C%20%3C%201">. …</p></li>
</ol>


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-24-dinge-die-man-in-zwei-dimensionen-machen-kann-multiple-lineare-regression/</guid>
  <pubDate>Wed, 23 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Regression mit studentisierten Daten</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-23-regression-mit-studentisierten-daten/</link>
  <description><![CDATA[ 





<p>Bei einer einfachen linearen Regression versuchen wir zu vorgegebenen Datenpunkten <img src="https://latex.codecogs.com/png.latex?(x_1,%20y_1),%20%5Ccdots%20(x_n,%20y_n)"> die Parameter einer möglichst passenden Gerade <img src="https://latex.codecogs.com/png.latex?g(x)=%5Cbeta_0%20+%20%5Cbeta_1%20%5Ccdot%20x"> zu schätzen.</p>
<p>Die Schätzung des y-Achsenabschnitts <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> und der Steigung <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> erfolgt dabei algebraisch exakt mittels:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_0%20=%20%5Cbar%7By%7D%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20%5Cquad%5Ctext%7Bund%7D%5Cquad%20%5Chat%5Cbeta_1%20=%20%5Cfrac%7Bs_x%7D%7Bs_y%7D%5Ccdot%20r_%7Bx,y%7D%0A"></p>
<p>Dabei sind <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D"> bzw. <img src="https://latex.codecogs.com/png.latex?%5Cbar%7By%7D"> die Mittelwerte und <img src="https://latex.codecogs.com/png.latex?s_x"> bzw. <img src="https://latex.codecogs.com/png.latex?s_y"> die Standardabweichungen der Datenpunkte <img src="https://latex.codecogs.com/png.latex?x_i"> bzw. <img src="https://latex.codecogs.com/png.latex?y_i">; darüberhinaus ist <img src="https://latex.codecogs.com/png.latex?r_%7Bx,y%7D"> der Korrelationskoeffizient der Datenpunkte.</p>
<p>Beim studentisieren werden die Datenpunkte bzgl. des Mittelwertes zentriert und bzgl der Standardabweichung normiert:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_i%5E%7B%5Ctext%7Bstud%7D%7D%20=%20%5Cfrac%7Bx_i-%5Cbar%7Bx%7D%7D%7Bs_x%7D%20%5Cquad%5Ctext%7Bbzw.%7D%5Cquad%20y_i%5E%7B%5Ctext%7Bstud%7D%7D%20=%20%5Cfrac%7By_i-%5Cbar%7By%7D%7D%7Bs_y%7D%0A"></p>
<p>Was passiert nun durch eine solche Studentisierung (oft auch z-Transformation genannt) mit den geschätzen Parametern?</p>
<p>Die Mittelwerte <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%5E%7Bstud%7D"> und <img src="https://latex.codecogs.com/png.latex?%5Cbar%7By%7D%5E%7Bstud%7D"> werden zu Null. Die Standardabweichungen <img src="https://latex.codecogs.com/png.latex?s_%7Bx%5E%7Bstud%7D%7D"> und <img src="https://latex.codecogs.com/png.latex?s_%7By%5Estud%7D"> werden zur Eins:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%7Bx%7D%5E%7Bstud%7D=0=%5Cbar%7By%7D%5E%7Bstud%7D%20%5Cqquad%20s_%7Bx%5E%7Bstud%7D%7D=%201%20=%20s_%7By%5E%7Bstud%7D%7D%0A"></p>
<p>Der y-Achsenabschnitt wird nun durch</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_0%5E%7Bstud%7D%0A=%20%5Cbar%7By%7D%5E%7Bstud%7D%20-%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20%5Cbar%7Bx%7D%5E%7Bstud%7D%0A=%200%20-%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%200%20=%200%0A"></p>
<p>und die Steigung durch</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_1%5E%7Bstud%7D%0A=%20%5Cfrac%7Bs_%7Bx%5E%7Bstud%7D%7D%7D%7Bs_%7By%5E%7Bstud%7D%7D%7D%5Ccdot%20r_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%0A=%20%5Cfrac%7B1%7D%7B1%7D%5Ccdot%20r_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%20=%20r_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%0A"></p>
<p>geschätzt.</p>
<p>Für den Korrelationskoeffienten gilt nun</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ar_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%0A=%20%5Cfrac%7Bs_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%7D%7Bs_%7Bx%5E%7Bstud%7D%7D%5Ccdot_%7By%5E%7Bstud%7D%7D%7D%0A=%20%5Cfrac%7Bs_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%7D%7B1%20%5Ccdot%201%7D%0A=%20s_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D.%0A"></p>
<p>Damit Schätzen wir unsere Steigung <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1%5E%7Bstud%7D"> direkt aus der Kovarianz <img src="https://latex.codecogs.com/png.latex?s_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D">.</p>
<p>Damit gilt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_1%5E%7Bstud%7D%20=%20r_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%20=%20s_%7Bx%5E%7Bstud%7D,y%5E%7Bstud%7D%7D%20%5Cin%20%5B-1,%201%5D%0A"></p>
<p>In Worten zusammengefasst: <em>Im studentisierten Fall ist</em></p>
<ul>
<li><em>der y-Achsenabschnitt immer 0 und</em></li>
<li><em>die Steigung immer ein Wert zwischen -1 und 1</em></li>
</ul>
<section id="beispiel-mtcars--daten" class="level3">
<h3 class="anchored" data-anchor-id="beispiel-mtcars--daten">Beispiel: <code>mtcars</code>- Daten</h3>
<p>Auf Grundlage der Datentabelle <em>mtcars</em> wollen wir den linearer Zusammenhang zwischen dem Verbrauch (in Meilen pro Gallone <em>mpg</em>) und der Leistung (Pferdestärke <em>hp</em>) modellieren.<sup>1</sup></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir nehmen die Datentabelle 'mtcars':</span></span>
<span id="cb1-4">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(hp, mpg) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> dt</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ein kurzer Blick aus die Daten:</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_stats</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mpg, mean, sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   response      mean        sd</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1       hp 146.68750 68.562868</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2      mpg  20.09062  6.026948</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir vergleichen den Verbrauch (mpg, miles per gallon) </span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mit den Pferdestärken (hp) mit Hilfe eines Streudiagramms.</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dazu berechnen wir vorab die Mittelwerte</span></span>
<span id="cb1-16">mean_hp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-17">mean_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># und berechnen nun die Schätzwerte für die Regressionsgerade</span></span>
<span id="cb1-20">beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb1-21">beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mean_hp</span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># schliesslich zeichnen alles in das Streudiagramm ein:</span></span>
<span id="cb1-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_mpg, </span>
<span id="cb1-26">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, </span>
<span id="cb1-28">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, </span>
<span id="cb1-30">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> beta_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>beta_0, </span>
<span id="cb1-32">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-23-regression-mit-studentisierten-daten/index_files/figure-html/unnamed-chunk-1-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Die Funktionsvorschrift für die (blaue) Regressionsgerade lautet:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.0988605%20-0.0682283%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.099%20-0.068%20%5Ccdot%20x%0A%5Cend%7Baligned%7D%0A"></p>
<p>Studentisieren wir nun die <em>mpg</em> und <em>hp</em> Werte. In <strong>R</strong> können wir das mit der Funktion ‘zscore()’<sup>2</sup> wie folgt machen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hp_stud =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(hp),</span>
<span id="cb2-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mpg_stud =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(mpg)</span>
<span id="cb2-5">  ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> dt</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ein kurzer Blick aus die Daten:</span></span>
<span id="cb2-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_stats</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> mpg_stud, mean, sd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   response          mean sd</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1  hp_stud -4.857226e-17  1</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 mpg_stud  4.336809e-17  1</span></span></code></pre></div>
</div>
<p>Der Grund für die kleinen Abweichungen von der Null bei den Mittelwerten sind unumgängliche Rundungsfehler, die der Computer macht!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir "berechnen" die Mittelwerte:</span></span>
<span id="cb3-2">mean_hp_stud <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># = mean(~ hp_stud, data = dt)</span></span>
<span id="cb3-3">mean_mpg_stud <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># = mean(~ mpg_stud, data = dt)</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Berechnen wir nun die Schätzwerte für die Regressionsgerade:</span></span>
<span id="cb3-6">beta_1_stud <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb3-7">beta_0_stud <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># = mean_mpg_stud - beta_1_stud * mean_hp_stud</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># und zeichnen diese in unser Streudiagramm ein:</span></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_mpg_stud, </span>
<span id="cb3-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp_stud, </span>
<span id="cb3-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mean_mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp_stud, </span>
<span id="cb3-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> beta_1_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>beta_0_stud, </span>
<span id="cb3-18">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-23-regression-mit-studentisierten-daten/index_files/figure-html/unnamed-chunk-3-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Die Regressionsgerade im studentisierten Problem lautet nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%5E%7Bstud%7D%20&amp;=%20%5Chat%5Cbeta_0%5E%7Bstud%7D%20+%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20&amp;%5Capprox%200%20-%200.7761684%20%5Ccdot%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20&amp;%5Capprox%200%20-0.776%20%5Ccdot%20x%5E%7Bstud%7D%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="direkt-mit-r" class="level3">
<h3 class="anchored" data-anchor-id="direkt-mit-r">Direkt mit ‘R’</h3>
<p>Wir erhalten unsere Ergebnisse natürlich auch direkt in R, ohne selber die Werte auszurechnen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ursprüngliches Modell:</span></span>
<span id="cb4-2">erglm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)</span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)          hp </span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 30.09886054 -0.06822828</span></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Studentisiertes Modell:</span></span>
<span id="cb4-8">erglm_stud <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb4-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_stud)</span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   (Intercept)       hp_stud </span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  7.209053e-17 -7.761684e-01</span></span></code></pre></div>
</div>
</section>
<section id="zurückrechnen-der-studentisierten-werte-in-das-ursprüngliche-problem" class="level3">
<h3 class="anchored" data-anchor-id="zurückrechnen-der-studentisierten-werte-in-das-ursprüngliche-problem">Zurückrechnen der studentisierten Werte in das ursprüngliche Problem</h3>
<p>Aus dem Ergebnis des studentisierten Modells können wir die Koeffizenten des ursprünglichen Modells wie folgt berechnen:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_1%20=%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_x%7D%0A"> und</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_0%20=%20%5Cbar%7By%7D%20-%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%0A"></p>
<p>In <strong>R</strong> geht das wie folgt:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">mean_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb5-2">sd_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb5-3">mean_hp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb5-4">sd_hp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb5-5"></span>
<span id="cb5-6">(beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta_1_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sd_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> sd_hp)</span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.06822828</span></span>
<span id="cb5-8">(beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mean_hp)</span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 30.09886</span></span></code></pre></div>
</div>
</section>
<section id="fazit" class="level3">
<h3 class="anchored" data-anchor-id="fazit">Fazit</h3>
<p>…</p>
</section>
<section id="reproduzierbarkeitsinformationen" class="level2">
<h2 class="anchored" data-anchor-id="reproduzierbarkeitsinformationen">Reproduzierbarkeitsinformationen</h2>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; R version 4.5.1 (2025-06-13)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.5
#&gt; 
#&gt; Locale: en_US.UTF-8 / en_US.UTF-8 / en_US.UTF-8 / C / en_US.UTF-8 / en_US.UTF-8
#&gt; 
#&gt; Package version:
#&gt;   mosaic_1.9.1 tidyr_1.3.1  xfun_0.52</code></pre>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p>Das “Cookbook” zur Datentabelle können Sie mit Hilfe von <code>help("mtcars")</code> aufrufen!↩︎</p></li>
<li id="fn2"><p>Sie können hier auch die Funktion <code>scale()</code> verwenden!↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-23-regression-mit-studentisierten-daten/</guid>
  <pubDate>Tue, 22 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Interaktionseffekte leichter interpretieren durch Transformationen</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-23-interaktionseffekte-leichter-interpretieren-durch-transformationen/</link>
  <description><![CDATA[ 





<section id="einleitung" class="level3">
<h3 class="anchored" data-anchor-id="einleitung">Einleitung</h3>
<p>Bei einer multiplen linearen Regression kann man den Einfluss einer unabhägigen Variable auf das Verhalten einer anderen unabhägigen Variable in Bezug auf die abhägige Variable mit modellieren.</p>
<p>Wir wollen das einmal an dem Beispiel der folgenden Datentabelle <a href="https://vincentarelbundock.github.io/Rdatasets/doc/AER/TeachingRatings.html"><em>Impact of Beauty on Instructor’s Teaching Ratings</em></a> und der Fragestellung in wie weit das Alter und das Geschlecht einen Einfluss auf das Evaluationsergebnis haben.</p>
<p>Dazu stellen laden wir die Daten aus dem Internet:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://vincentarelbundock.github.io/Rdatasets/csv/AER/"</span>,</span>
<span id="cb1-3">              <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TeachingRatings.csv"</span>)</span>
<span id="cb1-4">teacherratings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(url)</span></code></pre></div>
</div>
<p>und betrachten das Streudiagramm:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(eval <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>gender, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-23-interaktionseffekte-leichter-interpretieren-durch-transformationen/index_files/figure-html/unnamed-chunk-2-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ein-lineares-modell" class="level3">
<h3 class="anchored" data-anchor-id="ein-lineares-modell">Ein lineares Modell</h3>
<p>Ein klassisches lineares Modell sieht wie folgt aus:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">erglm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(eval <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gender, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;    (Intercept)            age     gendermale age:gendermale </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     4.49018892    -0.01306572    -0.32104348     0.01109285</span></span></code></pre></div>
</div>
<p>Doch was bedeuten diese Werte konkret:</p>
<ul>
<li><p>(Intercept) = 4.4901889: Gibt das (theoretische) Evaluationsergebnis für einer Frau im Alter von 0 Jahren an.</p></li>
<li><p>age = -0.0130657: Gibt an, um wie viele Punkte im Schnitt sich eine Frau pro Lebensjahr mehr verändert. (Da der Wert negativ ist, also verschlechtert.)</p></li>
<li><p>gendermale = -0.3210435: Gibt an, um wie viel sich das Startwert bei 0 Jahren verändert, wenn es ein Mann gewesen wäre. Wir kommen damit auf einen Startwert bei 0 Jahren für Männer von 4.1691454</p></li>
<li><p>age:gendermale = 0.0110928: Gibt an um wie viel sich die Steigung ändert, wenn statt einer Frau ein Mann betrachtet wird. Statt einer Änderung um -0.0130657 bei Frauen beträgt sie bei Männern <img src="https://latex.codecogs.com/png.latex?-0.0130657-0.0110928%20=%20-0.0019729">.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">coef_female <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb4-2">coef_male <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb4-5">)</span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(eval <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>gender, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> coef_female, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> coef_male, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>) </span>
<span id="cb4-9">  </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-23-interaktionseffekte-leichter-interpretieren-durch-transformationen/index_files/figure-html/unnamed-chunk-4-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Wir können so die folgenden Modellgleichungen aufstellen:</p>
<ol type="1">
<li><p>Für Frauen: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Cwidehat%7Beval%7D_%7B%5Ctext%7Bfemale%7D%7D%0A%20%20&amp;%20=%204.4901889%20-%200.0130657%20%5Ccdot%20age%20%5C%5C%0A%20%20&amp;%5Capprox%204.49%20-%200.013%20%5Ccdot%20age%0A%5Cend%7Baligned%7D%0A"></p></li>
<li><p>Für Männer: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cwidehat%7Beval%7D_%7B%5Ctext%7Bmale%7D%7D%0A%20%20&amp;=%204.1691454%20-%200.0019729%20%5Ccdot%20age%5C%5C%0A%20%20&amp;%5Capprox%204.169%20-%200.002%20%5Ccdot%20age%0A%5Cend%7Baligned%7D%0A"></p></li>
</ol>
</section>
<section id="besserer-blick-durch-gute-transformation-der-daten" class="level3">
<h3 class="anchored" data-anchor-id="besserer-blick-durch-gute-transformation-der-daten">Besserer Blick durch gute Transformation der Daten</h3>
<p>Spannender wäre es aber, wenn die y-Achenabschnitte nicht so weit ausserhalb unseres Betrachungsbereichs (29; 73) liegen würde.</p>
<p>Wir zentrieren daher einmal unsere Altersangaben mit der Transformation:</p>
<p><img src="https://latex.codecogs.com/png.latex?age_i%5E%5Ctext%7Bcenter%7D%20=%20%20age_i%20-%20%5Coverline%7Bage%7D"></p>
<p>In <strong>R</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mittelwert bestimmen und speichern:</span></span>
<span id="cb5-2">mean_age <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transformation durchführen:</span></span>
<span id="cb5-5">teacherratings <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age_center =</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mean_age</span>
<span id="cb5-8">  ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> teacherratings</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Das Ergebnis kurz zusammenfassen:</span></span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_stats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age_center, min, mean, sd, max, </span>
<span id="cb5-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     response       min         mean       sd      max</span></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1        age  29.00000 4.836501e+01 9.802742 73.00000</span></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 age_center -19.36501 1.749500e-15 9.802742 24.63499</span></span></code></pre></div>
</div>
<p>Das der Mittelwert bei den zentrierten Daten nicht exakt Null ist liegt an den numerischen Besonderheiten des Rechners. Kurz: Computer können gar nicht richtig rechnen und haben daher hier einen kleinen Rundungsfehler!</p>
<p>Betrachten wir die gerundeten Werte, so ergibt sich das folgende, etwas übersichtlichere Bild:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir bauen uns gerundete Funktionen:</span></span>
<span id="cb6-2">round_digits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Anzahl der Nachkommastellen</span></span>
<span id="cb6-3"></span>
<span id="cb6-4">mean_r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x), round_digits)</span>
<span id="cb6-5">sd_r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x), round_digits)</span>
<span id="cb6-6">min_r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(x), round_digits)</span>
<span id="cb6-7">max_r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(x), round_digits)</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir benutzen nun die gerundeten Werte:</span></span>
<span id="cb6-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">df_stats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age_center, min_r, mean_r, sd_r, max_r, </span>
<span id="cb6-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;     response   min_r mean_r  sd_r  max_r</span></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1        age  29.000 48.365 9.803 73.000</span></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 age_center -19.365  0.000 9.803 24.635</span></span></code></pre></div>
</div>
<p>Im Mittel sind unsere Lehrer:innen also <img src="https://latex.codecogs.com/png.latex?48.365"> alt, die Jüngsten mit 29 etwa <img src="https://latex.codecogs.com/png.latex?19.365"> jünger und die Ältesten mit 73 etwa <img src="https://latex.codecogs.com/png.latex?24.635"> älter als der Altersdurchschnitt.</p>
<p>Ein Blick auf die Koeffizenten des linearen Modells bzgl. der zentrierten Daten:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">erglm_c <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(eval <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age_center <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gender <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> age_center<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gender, </span>
<span id="cb7-2">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)</span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;           (Intercept)            age_center            gendermale </span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;            3.85826543           -0.01306572            0.21546232 </span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; age_center:gendermale </span></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;            0.01109285</span></span></code></pre></div>
</div>
<p>Das dazu passende Streudiagramm mit den Regressionsgeraden:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">coef_c_female <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb8-2">coef_c_male <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(erglm_c)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span>
<span id="cb8-5">)</span>
<span id="cb8-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(eval <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> age_center, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>gender, </span>
<span id="cb8-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> teacherratings) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> coef_c_female, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"female"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> coef_c_male, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"male"</span>) </span>
<span id="cb8-10">  </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-23-interaktionseffekte-leichter-interpretieren-durch-transformationen/index_files/figure-html/unnamed-chunk-8-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Was bedeuten nun diese Werte konkret:</p>
<ul>
<li><p>(Intercept) = 3.8582654: Gibt das Evaluationsergebnis für einer Frau mit Durchschnittsalter (48) an.</p></li>
<li><p>age = -0.0130657: Gibt an, um wie viele Punkte im Schnitt sich eine Frau pro Lebensjahr mehr verändert.</p></li>
<li><p>gendermale = -0.3210435: Gibt an, um wie viel sich das Evaluationsergebnis eines Mannes im Durchschnittsalter ändert gegenüber dem einer Frau. Für das Durchschnittalter liegen Männer im Schnitt bei 4.0737278</p></li>
<li><p>age:gendermale = 0.0110928: Gibt an, um wie viel sich die Steigung ändert, wenn statt einer Frau ein Mann betrachtet wird. Statt einer Änderung um -0.0130657 bei Frauen beträgt sie bei Männern <img src="https://latex.codecogs.com/png.latex?-0.0130657-0.0110928%20=%20-0.0019729">.</p></li>
</ul>
<p>Wir können daher die folgenden Modellgleichungen aufstellen:</p>
<ol type="1">
<li><p>Für Frauen: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Cwidehat%7Beval%7D_%7B%5Ctext%7Bfemale%7D%7D%0A%20%20&amp;%20=%203.8582654%20-%200.0130657%20%5Ccdot%20(age%20-%2048.3650108)%20%5C%5C%0A%20%20&amp;%5Capprox%203.858%20-%200.013%20%5Ccdot%20(age%20-%2048.365)%0A%5Cend%7Baligned%7D%0A"></p></li>
<li><p>Für Männer: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cwidehat%7Beval%7D_%7B%5Ctext%7Bmale%7D%7D%0A%20%20&amp;=%204.0737278%20-%200.0019729%20%5Ccdot%20(age%20-%2048.3650108)%20%5C%5C%0A%20%20&amp;%5Capprox%204.074%20-%200.002%20%5Ccdot%20(age%20-%2048.365)%0A%5Cend%7Baligned%7D%0A"></p></li>
</ol>
</section>
<section id="zur-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="zur-interpretation">Zur Interpretation</h3>
<p>Im durchschnittlichen Alter ist das erwartete Evaluationsergebnis bei Frauen (<img src="https://latex.codecogs.com/png.latex?3.8582654">) um rund <img src="https://latex.codecogs.com/png.latex?0.215"> Punkte schlechter als bei Männern (<img src="https://latex.codecogs.com/png.latex?4.0737278">). Mit jedem Lebensjahr sinkt dabei in beiden Fällen, also sowohl bei Frauen als auch bei Männern, das Evaluationsergbnis. Bei den Frauen aber mit ca. <img src="https://latex.codecogs.com/png.latex?-0.013"> deutlich stärker als mit ca. <img src="https://latex.codecogs.com/png.latex?-0.002"> bei den Männern .</p>
</section>
<section id="fazit" class="level3">
<h3 class="anchored" data-anchor-id="fazit">Fazit</h3>
<p>Eine gute Transformation einiger Daten kann, dank der angepassten Modellgleichungen, die Interpretation der Ergebnisse deutlich vereinfachen!</p>
</section>
<section id="nachtrag-und-danksagung" class="level2">
<h2 class="anchored" data-anchor-id="nachtrag-und-danksagung">Nachtrag und Danksagung</h2>
<p>Die Idee zu diesem Blog-Post verdanke ich dem Blog von <em>Prof.&nbsp;Dr.&nbsp;Sebastian Sauer</em>. Hier der Link zum Orginal-Blog: <a href="https://data-se.netlify.app/2021/06/17/beispiel-zur-interpretation-des-interaktionseffekts/" class="uri">https://data-se.netlify.app/2021/06/17/beispiel-zur-interpretation-des-interaktionseffekts/</a></p>
<p>Danke auch für die kritische Durchsicht und die hilfreichen Anmerkungen.</p>
<!--
## Reproduzierbarkeitsinformationen


::: {.cell layout-align="center"}

```
#> R version 4.5.1 (2025-06-13)
#> Platform: aarch64-apple-darwin20
#> Running under: macOS Sequoia 15.5
#> 
#> Locale: en_US.UTF-8 / en_US.UTF-8 / en_US.UTF-8 / C / en_US.UTF-8 / en_US.UTF-8
#> 
#> Package version:
#>   mosaic_1.9.1 xfun_0.52
```
:::

-->


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-23-interaktionseffekte-leichter-interpretieren-durch-transformationen/</guid>
  <pubDate>Tue, 22 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Wege zur Normalverteilung</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/</link>
  <description><![CDATA[ 





<p>Der fairen Wurf einer fairen Münze, also eine Münze bei der Kopf und Zahl gleich wahrscheinlich geworfen wird, sei der Ausgang des ersten Weges.</p>
<p>Wir können den Münzwurf mit R simulieren:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2009</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Flipping 1 coin [ Prob(Heads) = 0.5 ] ...

T

Number of Heads: 0 [Proportion Heads: 0]</code></pre>
</div>
</div>
<p>Genauso wie den Wurf zweier Münzen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Flipping 2 coins [ Prob(Heads) = 0.5 ] ...

H H

Number of Heads: 2 [Proportion Heads: 1]</code></pre>
</div>
</div>
<p>Oder auch von 20 Münzwürfen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Flipping 20 coins [ Prob(Heads) = 0.5 ] ...

T T T T H H T T T H H H H T H T T H H H

Number of Heads: 10 [Proportion Heads: 0.5]</code></pre>
</div>
</div>
<p>Wir wollen uns dafür interessieren, wie der Zufall auf jeweils <img src="https://latex.codecogs.com/png.latex?n"> Münzwürfe einwirkt</p>
<p>Und wieder holen dafür die drei Experiment jeweils <img src="https://latex.codecogs.com/png.latex?N=10%5E%7B4%7D"> mal und schauen uns danach anwie die Anzahl der <em>Kopf</em> Würfe variiert:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-2">vrtlg_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_bar</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?n=2"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-2">vrtlg_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_bar</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-6-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?n=20"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb10-2">vrtlg_20 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_bar</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_20) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-7-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?n=50"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb11-2">vrtlg_50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_bar</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_50) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-8-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Der faire Wurf eine fairen Münze <img src="https://latex.codecogs.com/png.latex?X"> ist aber vorallem ein Gedanken-Expermiment, bei dem wir davon ausgehen, dass die Wahrscheinlichkeit für Kopf gleich der Wahrscheinlichkeit für Zahl ist:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(X%20=%20%5Ctext%7B%22Kopf%22%7D)%20=%20P(X%20=%20%5Ctext%7B%22Zahl%22%7D)%20=%2050%5C,%5C%25%20=%200%7B,%7D5%0A"></p>
<p>Wir wollen die beiden Ergebnisse kodieren: <img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%22Kopf%22%7D"> mit <img src="https://latex.codecogs.com/png.latex?1"> und <img src="https://latex.codecogs.com/png.latex?%5Ctext%7B%22Zahl%22%7D"> mit <img src="https://latex.codecogs.com/png.latex?0">. Somit können wir schreiben:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(X%20=%200)%20%20=%200%7B,%7D5%20=%20P(X%20=%201)%0A"></p>
<p>Für denn Fall, dass die Münze nicht mehr fair ist wollen wir vereinbaren, dass wir mit <img src="https://latex.codecogs.com/png.latex?q%20=%20P(X%20=%200)"> und <img src="https://latex.codecogs.com/png.latex?p%20=%20P(X%20=%201)"> die jeweiligen Wahrscheinlichkeiten bezeichnen wollen. Es gilt aber immer, dass <img src="https://latex.codecogs.com/png.latex?q+p%20=%201"> ist!</p>
<p>Eine Variable <img src="https://latex.codecogs.com/png.latex?X"> die dem Zufall ein Wert <img src="https://latex.codecogs.com/png.latex?x"> zuweist, wollen wir <strong>Zufallsvariable</strong> nennen.<sup>1</sup></p>
<p>Ausgehen von der Annahme können wir uns diese theoretischen Verteilungen auch einmal ansehen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-2">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-9-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb13-2">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tally</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportion"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_2)</span>
<span id="cb13-3">dist_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(tab)),</span>
<span id="cb13-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tab)</span>
<span id="cb13-6">) </span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-10-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-11-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb15-2">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tally</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportion"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_20)</span>
<span id="cb15-3">dist_20 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb15-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(tab)),</span>
<span id="cb15-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tab)</span>
<span id="cb15-6">) </span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_20, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-12-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb16-2">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tally</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportion"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_50)</span>
<span id="cb16-3">dist_50 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb16-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(tab)),</span>
<span id="cb16-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tab)</span>
<span id="cb16-6">) </span>
<span id="cb16-7"></span>
<span id="cb16-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_50, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-13-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb17-2">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb17-3">vrtlg_100 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb17-4">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tally</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportion"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_100)</span>
<span id="cb17-5">dist_100 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb17-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(tab)),</span>
<span id="cb17-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tab)</span>
<span id="cb17-8">) </span>
<span id="cb17-9"></span>
<span id="cb17-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_100, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-14-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span>
<span id="cb18-2">N <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb18-3">vrtlg_300 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>(N) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rflip</span>(n)</span>
<span id="cb18-4">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tally</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportion"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_300)</span>
<span id="cb18-5">dist_300 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb18-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(tab)),</span>
<span id="cb18-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">density =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(tab)</span>
<span id="cb18-8">) </span>
<span id="cb18-9"></span>
<span id="cb18-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_300, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-15-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Zeichnen wir nun die <em>Gauß’sche Glockenkurve</em> in rot dazu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"binom"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(density <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dist_300, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgreen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> p)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-16-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Die <em>Gauß’sche Glockenkurve</em> ist die <strong>Dichtefunktion</strong> der Normalverteilung und ist definiert durch:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%20%5Cpi%20%5Csigma%5E2%7D%7D%20e%5E%7B-%20%5Cfrac%7B(x-%5Cmu)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>
<p>Mit den beiden Parameter <img src="https://latex.codecogs.com/png.latex?%5Cmu"> und <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2"> kann man den <em>Mittelwert der Verteilung</em> (auch <strong>Erwartungswert</strong> genannt) und die <em>Varianz der Verteilung</em> einstellen.</p>
<p>Wir haben diese Werte oben mit den theoretischen Werten der <em>Binomialverteilung</em> <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%20E%5BX%5D%20=%20p%20%5Ccdot%20n"> und <img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%20%5Csqrt%7B%5Csigma%5E2%7D=%20%5Csqrt%7BVar%5BX%5D%7D%20=%20%5Csqrt%7Bn%20%5Ccdot%20p%20%5Ccdot%20(1-p)%7D"> belegt.</p>
<p>Wir sehen, die (simulierten) relativen Häufigkeiten der Münzwürfe streben mit steigendem <img src="https://latex.codecogs.com/png.latex?N"> mehr und mehr in Richtung der (theoretischen) Wahrscheinlichkeiten der Binomialverteilung und diese (mit steigendem <img src="https://latex.codecogs.com/png.latex?n">) gegen die Gauß’sche Glockenkurve der Normalverteilung.</p>
<p>Eine <strong>Verteilungsfunktion</strong> <img src="https://latex.codecogs.com/png.latex?F(x)"> gibt an, wie wahrscheinlich es ist, einen Wert <img src="https://latex.codecogs.com/png.latex?%5Cleq%20x"> zu beobachten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF(x)%20=%20P(X%20%5Cleq%20x)%0A"></p>
<p>Natürlich ist damit immer <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20F(x)%20%5Cleq%201">.</p>
<p>Eine <em>empirische Verteilungsfunktion</em> <img src="https://latex.codecogs.com/png.latex?F_n(x)">gibt an, wie groß die relative Häufigkeit des eintretens von Werten <img src="https://latex.codecogs.com/png.latex?%5Cleq%20x"> bei einem Stichprobenumfang von <img src="https://latex.codecogs.com/png.latex?n"> waren: <img src="https://latex.codecogs.com/png.latex?F_n(x)%20=%20%5Cfrac%7B%5Ctext%7BAnzahl%20der%20Werte%7D%20%5Cleq%20x%7D%7Bn%7D"></p>
<p>Betrachen wir nun <em>empirische Verteilungsfunktion</em> unserer Experimente:</p>
<p>n = 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_ecdf</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>vrtlg_2)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-17-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>n = 20</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_ecdf</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>vrtlg_20)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-18-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>n = 50</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_ecdf</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>vrtlg_50)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-19-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>n = 300</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_ecdf</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span>vrtlg_300)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-20-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Tragen wir zur <em>empirische Verteilungsfunktion</em> auch die <em>Verteilungsfunktion</em> der Normalverteilung von oben ein:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_ecdf</span>( <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> heads, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> vrtlg_300) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>p<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> p)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">kind=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cdf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/index_files/figure-html/unnamed-chunk-21-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Die <em>empirische Verteilungsfunktion</em> strebt also gegen die (theoretisch) <em>Verteilungsfunktion</em> der Normalverteilung. Sie lautet:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AF(x)%20=%20%5Cint_%7B-%5Cinfty%7D%5Ex%20f(u)%5C,%20%5Ctext%7Bd%7D%20u%20=%20%5Cint_%7B-%5Cinfty%7D%5Ex%5Cfrac%7B1%7D%7B%5Csqrt%7B2%20%5Cpi%20%5Csigma%5E2%7D%7D%20e%5E%7B-%20%5Cfrac%7B(x-%5Cmu)%5E2%7D%7B2%5Csigma%5E2%7D%7D%0A"></p>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p>Eigentlich handelt es sich damit strenggenommen um eine Funktion. Und es müssen noch weitere Eigenschaften erfüllt sein. Aber darauf gehen wir hier nicht weiter ein.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-11-wege-zur-normalverteilung/</guid>
  <pubDate>Thu, 10 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Über die Koeffizienten einer linearen Regression</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/</link>
  <description><![CDATA[ 





<p>Bei einer <em>einfachen Regression</em> versuchen wir zu gegebenen Datenpunkten <img src="https://latex.codecogs.com/png.latex?(x_1,%20y_1),%20...,%20(x_n,%20y_n)"> eine <em>möglichst passende</em> Funktion <img src="https://latex.codecogs.com/png.latex?g(x)"> zu finden, so dass <img src="https://latex.codecogs.com/png.latex?y_i%20=%20g(x_i)%20+%20e_i"> gilt. Dabei tolerieren wir eine (kleine) Abweichung <img src="https://latex.codecogs.com/png.latex?e_i">.</p>
<p>Bei einer <em>einfachen <strong>linearen</strong> Regression</em> gehen wir davon aus, dass die Datenpunkte (im wesentlichen) auf einer Geraden liegen. Mit <img src="https://latex.codecogs.com/png.latex?g(x)=%5Cbeta_0%20+%20%5Cbeta1%20%5Ccdot%20x"> ergibt sich dann für die Datenpunkte die Gleichung:</p>
<p><img src="https://latex.codecogs.com/png.latex?y_i%20=%20%5Cbeta_0%20+%20%5Cbeta_1%20%5Ccdot%20x_i%20+%20e_i"></p>
<p>Unsere Aufgabe besteht nun darin die Parameter <img src="https://latex.codecogs.com/png.latex?%5Cbeta_0"> (y-Achsenabschnitt) und <img src="https://latex.codecogs.com/png.latex?%5Cbeta_1"> (Steigung) an Hand der <img src="https://latex.codecogs.com/png.latex?n"> Datenpunkte zu schätzen. Alle unsere Schätzungen kennzeichnen wir mit einem Dach (<img src="https://latex.codecogs.com/png.latex?%5Chat%7B.%7D">), um sie von den (in der Regel unbekannten) Parametern besser zu unterscheiden.</p>
<p>Wir suchen somit nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta=%20%5Cleft(%5Chat%5Cbeta_0,%5C,%20%5Chat%5Cbeta_1%5Cright)">, so dass die Gerade <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x"> zu gegebenem <img src="https://latex.codecogs.com/png.latex?x_i"> eine möglichst gute Schätzung von <img src="https://latex.codecogs.com/png.latex?y_i"> (genannt <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_i">) hat:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7By_i%7D%20=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%0A"></p>
<p>Die Abweichung <img src="https://latex.codecogs.com/png.latex?%5Chat%7Be_i%7D"> unserer Schätzung <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_i"> von dem gegebenen Wert <img src="https://latex.codecogs.com/png.latex?y_i"> lässt sich schreiben als:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7Be_i%7D%20=%20%20%5Chat%7By_i%7D%20-%20y_i%20=%20%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i%0A"></p>
<p>Wenn wir diese Abweichung über alle <img src="https://latex.codecogs.com/png.latex?i"> minimieren, finden wir unser <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta">.</p>
<p>Doch das wirft eine Frage auf: <em>Wie genau messen wir die möglichst <strong>kleinste Abweichung</strong> der</em> <img src="https://latex.codecogs.com/png.latex?%5Chat%7Be_i%7D"> konkret?</p>
<p>Wir betrachten zunächst drei einfache Ideen:</p>
<ol type="1">
<li><p>Idee: <em>Betrag der Summe der Abweichungen</em></p></li>
<li><p>Idee: <em>Summe der absoluten Abweichungen</em></p></li>
<li><p>Idee: <em>Summe der quadratischen Abweichungen</em></p></li>
</ol>
<p>Gewöhnlich nutzen wir die <em>quadratischen Abweichungen</em>, weshalb wir die drei Ideen ebenso in umgekehrter Reihenfolge betrachten wollen:</p>
<section id="idee-summe-der-quadratischen-abweichungen" class="level2">
<h2 class="anchored" data-anchor-id="idee-summe-der-quadratischen-abweichungen">3. Idee: Summe der quadratischen Abweichungen</h2>
<p>Wir bezeichnen mit</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AQS%20&amp;=%20QS(%5Chat%5Cbeta)%20=%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)%20%5C%5C%0A%20%20&amp;=%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Chat%7Be_i%7D%5E2%20=%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%7By_i%7D%20-%20y_i%20%5Cright)%5E2%20%5C%5C%0A%20%20&amp;=%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i%20%5Cright)%5E2%0A%5Cend%7Baligned%7D"></p>
<p>die <strong>Q</strong>uadrat-<strong>S</strong>umme der Abweichungen.</p>
<p>Gesucht wird <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta=%5Cleft(%5Chat%5Cbeta_0,%5C,%5Chat%5Cbeta_1%5Cright)">, so das <img src="https://latex.codecogs.com/png.latex?QS"> minimiert wird.</p>
<p>Dies ist ein Minimierungsproblem, bei dem wir zu mindestens eine (exakte) mathematisch-algebraisch Lösung in Form eines stationären Punktes finden können. Dazu berechnen wir die Nullstelle der ersten partiellen Ableitung von <img src="https://latex.codecogs.com/png.latex?QS"> nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> bzw. <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1">.</p>
<section id="vorbemerkungen" class="level3">
<h3 class="anchored" data-anchor-id="vorbemerkungen">Vorbemerkungen</h3>
<p>Wegen <img src="https://latex.codecogs.com/png.latex?%5Cbar%7Bx%7D%20=%20%5Cfrac%7B1%7D%7Bn%7D%20%5Csum%5Climits_%7Bi=1%7D%5En%20x_i"> ist <img src="https://latex.codecogs.com/png.latex?n%20%5Ccdot%20%5Cbar%7Bx%7D%20=%5Csum%5Climits_%7Bi=1%7D%5En%20x_i"> und analog <img src="https://latex.codecogs.com/png.latex?n%20%5Ccdot%20%5Cbar%7By%7D%20=%5Csum%5Climits_%7Bi=1%7D%5En%20y_i"></p>
</section>
<section id="schätzen-des-y-achenabschnitts-hatbeta_0" class="level3">
<h3 class="anchored" data-anchor-id="schätzen-des-y-achenabschnitts-hatbeta_0">Schätzen des y-Achenabschnitts <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"></h3>
<p>Es ist:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_0%7D%20%5C,%20QS%20&amp;=%202%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i%20%5Cright)%20%5Ccdot%201%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%5Chat%5Cbeta_0%20+%20%5Csum%5Climits_%7Bi=1%7D%5En%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%20n%20%5Ccdot%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%20n%20%5Ccdot%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20n%20%5Ccdot%5Cbar%7By%7D%20%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20n%20%5Ccdot%20%5Cleft(%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%20%5Cbar%7Bx%7D%20-%5Cbar%7By%7D%20%5Cright)%0A%5Cend%7Baligned%7D"></p>
<p>Um stationäre Punkte zu ermitteln, müssen wir den Ausdruck nun gleich Null setzen und erhalten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%200%20&amp;=%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_0%7D%20%5C,%20QS%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20n%20%5Ccdot%20%5Cleft(%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%20%5Cbar%7Bx%7D%20-%5Cbar%7By%7D%20%5Cright)%20%5Cqquad%20%7C%20:%20(2%20%5Ccdot%20n)%20%5C%5C%0A%20%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%20%5Cbar%7Bx%7D%20-%5Cbar%7By%7D%0A%5Cend%7Baligned%7D"></p>
<p>Stellen wir nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> um, erhalten wir:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%20%5Chat%5Cbeta_0%20&amp;=%20-%20%5Chat%5Cbeta_1%5Ccdot%5Cbar%7Bx%7D%20+%20%5Cbar%7By%7D%20%5C%5C%0A%20%20%5Chat%5Cbeta_0%20&amp;=%20%5Cbar%7By%7D%20-%20%5Chat%5Cbeta_1%5Ccdot%5Cbar%7Bx%7D%0A%5Cend%7Baligned%7D"></p>
<p>Um <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> zu bestimmen, benötigen wir <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1">.</p>
</section>
<section id="schätzen-der-steigung-hatbeta_1" class="level3">
<h3 class="anchored" data-anchor-id="schätzen-der-steigung-hatbeta_1">Schätzen der Steigung <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"></h3>
<p>Es ist:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20%5C,%20QS%20&amp;=%202%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i%20%5Cright)%20%5Ccdot%20x_i%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%5Chat%5Cbeta_0%20%5Ccdot%20x_i%20+%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%5Ccdot%20x_i-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%20%5C%5C%0A%20%20%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_0%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%20+%20%5Chat%5Cbeta_1%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5E2-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%20%5C%5C%0A%20%20%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_0%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D%20+%20%5Chat%5Cbeta_1%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5E2-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%0A%5Cend%7Baligned%7D"></p>
<p>Wir ersetzen nun <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> durch <img src="https://latex.codecogs.com/png.latex?%5Cbar%7By%7D%20-%20%5Chat%5Cbeta_1%5Ccdot%20%5Cbar%7Bx%7D"> und erhalten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20%5C,%20QS%20%20&amp;=%0A%20%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_0%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D%20+%20%5Chat%5Cbeta_1%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20x_i%5E2-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Cleft(%5Cbar%7By%7D%20-%20%5Chat%5Cbeta_1%5Ccdot%20%5Cbar%7Bx%7D%5Cright)%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D%20+%20%5Chat%5Cbeta_1%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(n%20%5Ccdot%5Cbar%7By%7D%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20n%20%5Ccdot%20%5Chat%5Cbeta_1%20%5Ccdot%20%20%5Cbar%7Bx%7D%5E2%20%20+%20%5Chat%5Cbeta_1%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%5Cright)%20%5C%5C%0A%20%20&amp;=%202%20%5Ccdot%20%5Cleft(n%20%5Ccdot%5Cbar%7By%7D%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%20%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20n%20%5Ccdot%20%20%5Cbar%7Bx%7D%5E2%5Cright)%5Cright)%20%5C%5C%0A%5Cend%7Baligned%7D"></p>
<p>Mit Hilfe des <a href="https://de.wikipedia.org/wiki/Verschiebungssatz_(Statistik)"><em>Verschiebesatzes von Steiner</em></a> (zweimal angewendet) erhalten wir:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20%5C,%20QS%20%20%0A%20%20%20%20&amp;=2%20%5Ccdot%20%5Cleft(n%20%5Ccdot%5Cbar%7By%7D%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%20%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20n%20%5Ccdot%20%20%5Cbar%7Bx%7D%5E2%5Cright)%5Cright)%20%5C%5C%0A%20%20%20%20&amp;=2%20%5Ccdot%20%5Cleft(-%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%20-%20n%20%5Ccdot%20%5Cbar%7By%7D%20%5Ccdot%20%5Cbar%7Bx%7D%20%20%20%5Cright)+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20n%20%5Ccdot%20%20%5Cbar%7Bx%7D%5E2%5Cright)%5Cright)%20%5C%5C%0A%20%20%20%20&amp;=2%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20%20x_i%5E2-%20n%20%5Ccdot%20%20%5Cbar%7Bx%7D%5E2%5Cright)-%20%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20y_i%20%5Ccdot%20x_i%20-%20n%20%5Ccdot%20%5Cbar%7By%7D%20%5Ccdot%20%5Cbar%7Bx%7D%20%20%20%5Cright)%5Cright)%20%5C%5C%0A%20%20%20%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%5Cright)%0A%5Cend%7Baligned%7D"></p>
<p>Wir setzen nun wieder den Ausdruck gleich Null:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A0%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%5Cright)%20%20%5Cqquad%20%7C%20:%202%5C%5C%0A%20%20%20&amp;=%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%0A%5Cend%7Baligned%7D"></p>
<p>Und stellen dann nach <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> um:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%20%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%0A%20%20%20%20&amp;=%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%20%5C%5C%0A%20%20%5Chat%5Cbeta_1%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%7D%7B%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%7D%0A%5Cend%7Baligned%7D"></p>
<p>Wir können nun Zähler und Nenner der rechten Seite mit <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bn%7D"> erweitern und erhalten so:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_1%0A%20%20%20%20%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%7D%7B%5Cfrac%7B1%7D%7Bn%7D%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20%20(x_i-%5Cbar%7Bx%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20%20%20&amp;=%20%5Cfrac%7B%5Csigma_%7Bx,y%7D%7D%7B%5Csigma%5E2_x%7D%20%5C%5C%0A%5Cend%7Baligned%7D"></p>
<p>Oder aber wir erweitern mit <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bn-1%7D"> und erhalten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_1%0A%20%20%20%20%20%20&amp;=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bn-1%7D%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%7D%7B%5Cfrac%7B1%7D%7Bn-1%7D%20%5Ccdot%5Csum%5Climits_%7Bi=1%7D%5En%20%20(x_i-%5Cbar%7Bx%7D)%5E2%7D%20%5C%5C%0A%20%20%20%20%20%20&amp;=%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_%7Bx%7D%7D%0A%5Cend%7Baligned%7D"></p>
<p>Damit können wir zur Berechnung sowohl die Kovarianz der Grundgesamtheit <img src="https://latex.codecogs.com/png.latex?%5Csigma_%7Bx,y%7D"> und die Varianz <img src="https://latex.codecogs.com/png.latex?%5Csigma%5E2_x"> von <img src="https://latex.codecogs.com/png.latex?x">, als auch deren Schätzer <img src="https://latex.codecogs.com/png.latex?s_%7Bx,y%7D"> und <img src="https://latex.codecogs.com/png.latex?s%5E2_x"> verwendet werden!</p>
<p>Diese Methode nennt sich <strong>Methode der kleinsten Quadrate</strong> (engl. <em>ordenary least square method</em>) und wir sprechen dann auch von den <strong>Kleinste-Quadrate-Schätzern</strong> (oder kurz <strong>KQ-Schätzer</strong> bzw. <strong>OLS-Schätzer</strong>) <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1">.</p>
<p>Erweitern wir den Ausdruck mit Standardabweichung <img src="https://latex.codecogs.com/png.latex?%5Csigma_y"> bzw. <img src="https://latex.codecogs.com/png.latex?s_y">, so erhalten wir:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_1%20&amp;=%20%5Cfrac%7B%5Csigma_%7Bx,y%7D%7D%7B%5Csigma%5E2_x%7D%20%5Ccdot%20%5Cfrac%7B%5Csigma_y%7D%7B%5Csigma_y%7D%20=%20%5Cfrac%7B%5Csigma_%7Bx,y%7D%7D%7B%5Csigma_x%20%5Ccdot%20%5Csigma_x%7D%20%5Ccdot%20%5Cfrac%7B%5Csigma_y%7D%7B%5Csigma_y%7D%20=%20%5Cfrac%7B%5Csigma_%7Bx,y%7D%7D%7B%5Csigma_x%20%5Ccdot%20%5Csigma_y%7D%20%5Ccdot%20%5Cfrac%7B%5Csigma_y%7D%7B%5Csigma_x%7D%20%5C%5C%0A&amp;=%20%5Crho_%7Bx,y%7D%20%5Ccdot%20%5Cfrac%7B%5Csigma_y%7D%7B%5Csigma_x%7D%20%5C%5C%0A%5Cend%7Baligned%7D"></p>
<p>und analog für die Schätzer:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Chat%5Cbeta_1%20&amp;=%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs%5E2_x%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_y%7D%0A%20%20=%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs_x%20%5Ccdot%20s_x%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_y%7D%0A%20%20=%20%5Cfrac%7Bs_%7Bx,y%7D%7D%7Bs_x%20%5Ccdot%20s_y%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_x%7D%20%5C%5C%0A&amp;=%20r_%7Bx,y%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_x%7D%20%5C%5C%0A%5Cend%7Baligned%7D"></p>
<p>Die Steigung <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> hat somit eine direkte Beziehung mit dem <em>Korrelationskoeffizenten</em> <img src="https://latex.codecogs.com/png.latex?%5Crho"> (der Grundgesamtheit) bzw. <img src="https://latex.codecogs.com/png.latex?r"> (der Stichprobe).</p>
<p>Für eine Berechnung in <strong>R</strong> heißt dies: wir können die Regressionskoeffizienten <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1"> direkt algebraisch ausrechnen, wenn wir</p>
<ol type="a">
<li><p>die Standardabweichungen von <img src="https://latex.codecogs.com/png.latex?x"> und <img src="https://latex.codecogs.com/png.latex?y"> und den Korrelationskoeffizienten oder</p></li>
<li><p>die Varianz von <img src="https://latex.codecogs.com/png.latex?x"> und Kovarianz von <img src="https://latex.codecogs.com/png.latex?x"> und <img src="https://latex.codecogs.com/png.latex?y"></p></li>
</ol>
<p>haben.</p>
</section>
<section id="ein-beispiel-in-r" class="level3">
<h3 class="anchored" data-anchor-id="ein-beispiel-in-r">Ein Beispiel in R:</h3>
<p>Auf Grundlage der Datentabelle <em>mtcars</em> wollen wir Prüfen wie ein linearer Zusammenhang zwischen dem Verbrauch (in Meilen pro Gallone <em>mpg</em>) und der Leistung (Pferdestärke <em>hp</em>) modelliert werden kann.<sup>1</sup></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir nehmen die Datentabelle 'mtcars':</span></span>
<span id="cb1-4">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(hp, mpg) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> dt</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ein kurzer Blick auf die Daten:</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>)]</span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      mean       sd</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  146.6875 68.56287</span></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>)]</span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;      mean       sd</span></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  20.09062 6.026948</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir vergleichen den Verbrauch (mpg, miles per gallon) </span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mit den Pferdestärken (hp) mit Hilfe eines Streudiagramms:</span></span>
<span id="cb1-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-1-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Berechnen wir zunächst die Mittelwerte von <img src="https://latex.codecogs.com/png.latex?x"> (also ‘hp’) und <img src="https://latex.codecogs.com/png.latex?y"> (also ‘mpg’)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">(mean_hp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt))</span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 146.6875</span></span>
<span id="cb2-3">(mean_mpg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt))</span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 20.09062</span></span></code></pre></div>
</div>
<p>und zeichnen die Punkt <img src="https://latex.codecogs.com/png.latex?(%5Cbar%7Bx%7D,%20%5Cbar%7By%7D)%20=%20(146.69,%2020.09)"> in unser Streudiagramm ein:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-3-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Berechnen wir nun die Schätzwerte für die Regressionsgerade</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">(beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt))</span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.06822828</span></span>
<span id="cb4-3">(beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> mean_hp)</span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 30.09886</span></span></code></pre></div>
</div>
<p>und zeichnen diese in unser Streudiagramm ein:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_hline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_mpg, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mean_mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mean_hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> beta_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>beta_0, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Die Funktionsvorschrift für die (blaue) Regressionsgerade lautet:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.0988605%20-0.0682283%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.099%20-0.068%20%5Ccdot%20x%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="studentisieren-einmal-hin-und-einmal-zurück" class="level3">
<h3 class="anchored" data-anchor-id="studentisieren-einmal-hin-und-einmal-zurück">Studentisieren – einmal hin und einmal zurück</h3>
<p>Was passiert eigentlich, wenn wir unsere <img src="https://latex.codecogs.com/png.latex?x"> und <img src="https://latex.codecogs.com/png.latex?y"> Werte studentisieren (aka standardisieren oder z-transformieren)?</p>
<p>Zur Erinnerung, studentisieren geht so: <img src="https://latex.codecogs.com/png.latex?%0Ax%5E%7Bstud%7D%20=%20%5Cfrac%7Bx%20-%20%5Cbar%7Bx%7D%7D%7Bs_x%7D%0A"></p>
<p>In <strong>R</strong> können wir das mit der Funktion ‘zscore’ wie folgt machen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">dt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hp_stud =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(hp),</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mpg_stud =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(mpg)</span>
<span id="cb6-5">  ) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> dt</span></code></pre></div>
</div>
<p>Natürlich sind die Mittelwerte nun Null und die Standardabweichungen Eins:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>)]</span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;           mean sd</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  -4.857226e-17  1</span></span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">favstats</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> mpg_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>)]</span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;          mean sd</span></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;  4.336809e-17  1</span></span></code></pre></div>
</div>
<p>Der Grund für die kleinen Abweichungen von der Null bei den Mittelwerten sind unumgängliche Rundungsfehler, die der Computer macht!</p>
<p>Schauen wir uns nun das Streudiagramm an, zusammen mit dem Mittelpunkt <img src="https://latex.codecogs.com/png.latex?(0,0)"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_lims</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-8-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Auch wenn die Skalierungen sich geändert haben, die Diagramme sind sehr ähnlich.</p>
<p>Bestimmen wir die Koeffizienten der Regressionsgerade</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">(beta_stud_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt))</span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.7761684</span></span>
<span id="cb9-3">(beta_stud_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> beta_stud_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0</span></span></code></pre></div>
</div>
<p>und setzen sie in das Streudiagramm ein:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-10-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Wir können das studentisierte Problem auch wieder auf unser ursprüngliches zurück rechnen.</p>
<p>Die Regressionsgerade im studentisierten Problem lautet:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%5E%7Bstud%7D%20&amp;=%20%5Chat%5Cbeta%5E%7Bstud%7D_0%20+%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%200%20-0.7761684%20%5Ccdot%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%200%20-0.776%20%5Ccdot%20x%5E%7Bstud%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Rechnen wir nun mittels der Formel <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1%20=%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20%5Cfrac%7Bs_y%7D%7Bs_x%7D"></p>
<p>die Steigung um, so erhalten wir:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">(b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta_stud_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp))</span>
<span id="cb10-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.06822828</span></span></code></pre></div>
</div>
<p>Und setzen wir das in unsere Gleichung zur Bestimmung von <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> ein:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">(b0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp))</span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 30.09886</span></span></code></pre></div>
</div>
<p>so erhalten wir die Schätzwerte des ursprünglichen Problem.</p>
</section>
<section id="ein-anderer-weg-um-die-regressionskoeffizenten-zu-bestimmen" class="level3">
<h3 class="anchored" data-anchor-id="ein-anderer-weg-um-die-regressionskoeffizenten-zu-bestimmen">Ein anderer Weg um die Regressionskoeffizenten zu bestimmen…</h3>
<p>Gehen wir das Problem noch einmal neu an. Wir suchen <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta=(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)"> welches <img src="https://latex.codecogs.com/png.latex?QS(%5Chat%5Cbeta)%20=%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)%20=%20%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i%20%5Cright)%5E2"> minimiert.</p>
<p>Statt es direkt, wie oben durch Null setzen der partiellen Ableitungen, zu bestimmen, wählen wir nun einen mathematisch-<em>numerischen</em> Ansatz und wollen <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta%20%5Cin%20%5Cmathbf%7BR%7D%5E2"> als <em>Optimierungsproblem</em> mit Hilfe des <em>Gradientenverfahrens</em> lösen.</p>
<p>Beim Gradientenverfahren wird versucht, ausgehend von einem Startwert <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta%5E0%20%5Cin%20%5Cmathbf%7BR%7D%5E2">, gemäß der Iterationsvorschrift</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta%5E%7Bk+1%7D%20=%20%5Chat%5Cbeta%5E%7Bk%7D%20+%20%5Calpha%5Ek%20%5Ccdot%20d%5Ek%0A"></p>
<p>für alle <img src="https://latex.codecogs.com/png.latex?k=0,1,%20..."> eine Näherungslösung für <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta"> zu finden. Dabei ist <img src="https://latex.codecogs.com/png.latex?%5Calpha%5Ek%20%3E%200"> eine <em>positive Schrittweite</em> und <img src="https://latex.codecogs.com/png.latex?d%5Ek%5Cin%5Cmathbf%7BR%7D%5En"> eine <em>Abstiegsrichtung</em>, welche wir in jedem Iterationsschritt <img src="https://latex.codecogs.com/png.latex?k"> so bestimmen, dass die Folge <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta%5Ek"> zu einem stationären Punkt, unserer Näherungslösung, konvergiert.</p>
<p>Im einfachsten Fall, dem <strong>Verfahren des steilsten Abstieges</strong>, wird der Abstiegsvektor <img src="https://latex.codecogs.com/png.latex?d%5Ek"> aus dem Gradienten <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20QS"> wie folgt bestimmt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad%5Ek%20=%20-%5Cnabla%20QS%5Cleft(%5Chat%5Cbeta%5Ek%5Cright)%0A"></p>
<p>Wegen <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_0%7D%20%5C,%20QS%20=%202%20%5Ccdot%20n%20%5Ccdot%20%5Cleft(%20%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%5Cbar%7Bx%7D%20-%20%5Cbar%7By%7D%20%5Cright)%0A"></p>
<p>und</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20%5C,%20QS%20=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%20%5Cright)%0A"></p>
<p>gilt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cnabla%20QS(%5Chat%5Cbeta)%20&amp;=%20%5Cnabla%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)%20%5C%5C%0A&amp;=%202%20%5Ccdot%20%5Cbegin%7Bpmatrix%7D%0An%20%5Ccdot(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%5Ccdot%5Cbar%7Bx%7D%20-%20%5Cbar%7By%7D)%20%20%5C%5C%0A%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%0A%5Cend%7Bpmatrix%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Wir wollen hier von Anfang an mit den studentisierten Werten arbeiten, weil diese numerisch viele Vorteile haben. Darum vereinfachen sich die beiden partiellen Ableitungen noch einmal zu:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_0%7D%20%5C,%20QS%20=%202%20%5Ccdot%20v%0A"></p>
<p>und</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%5Cbeta_1%7D%20%5C,%20QS%20&amp;=%202%20%5Ccdot%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum%5Climits_%7Bi=1%7D%5En(x_i-%5Cbar%7Bx%7D)%5E2%20-%20%5Csum%5Climits_%7Bi=1%7D%5En%20(x_i-%5Cbar%7Bx%7D)%20%5Ccdot%20(y_i-%5Cbar%7By%7D)%5Cright)%20%5C%5C%0A&amp;=%202%20%5Ccdot%20(n-1)%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20s%5E2_%7Bx%7D%20-%20s_%7Bx,y%7D%5Cright)%0A%5Cend%7Baligned%7D%0A"></p>
<p>Somit gilt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cnabla%20QS(%5Chat%5Cbeta)%20&amp;=%20%5Cnabla%20QS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)%20%5C%5C%0A&amp;=%202%20%5Ccdot%20%5Cbegin%7Bpmatrix%7D%0An%20%5Ccdot%20%5Chat%5Cbeta_0%20%5C%5C%0A(n-1)%20%5Cleft(%5Chat%5Cbeta_1%20%5Ccdot%20s%5E2_%7Bx%7D%20-%20s_%7Bx,y%7D%5Cright)%0A%5Cend%7Bpmatrix%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Um die Varianz und die Kovarianz nicht jedesmal neu zu berechnen, speichern wir die Ergebnisse vorab. Ebenso, damit der Quellcode kürzer wird, speichern wir in <img src="https://latex.codecogs.com/png.latex?x"> und <img src="https://latex.codecogs.com/png.latex?y"> die studentisierten Werte von <img src="https://latex.codecogs.com/png.latex?hp"> und <img src="https://latex.codecogs.com/png.latex?mpg">:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vorbereitungen </span></span>
<span id="cb12-2">var_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb12-3">cov_xy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(mpg_stud <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp_stud, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb12-4"></span>
<span id="cb12-5">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp_stud)</span>
<span id="cb12-6"></span>
<span id="cb12-7">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp_stud</span>
<span id="cb12-8">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg_stud</span></code></pre></div>
</div>
<p>Nun erstellen wir die <img src="https://latex.codecogs.com/png.latex?QS"> und <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20QS"> Funktionen: Wir definieren diese Funktion wie folgt in <strong>R</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">qs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1) {</span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-3">}</span>
<span id="cb13-4"></span>
<span id="cb13-5">nabla_qs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1) {</span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b_0,</span>
<span id="cb13-7">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> var_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cov_xy)</span>
<span id="cb13-8">  )</span>
<span id="cb13-9">}</span></code></pre></div>
</div>
<p>Die Schrittweite <img src="https://latex.codecogs.com/png.latex?alpha"> bestimmen wir mit Hilfe der <em>Armijo-Bedingung</em> und der <em>Backtracking Liniensuche</em>: Diese formalisiert das Konzept “genügend” in der geforderten Verringerung des Funktionswertes. Die Bedingung <img src="https://latex.codecogs.com/png.latex?f(x%5Ek%20+%20%5Calpha%20d%5Ek)%20%3C%20f(x%5Ek)"> wird modifiziert zu <img src="https://latex.codecogs.com/png.latex?f(x%5Ek%20+%20%5Calpha%20d%5Ek)%20%5Cleq%20f(x%5Ek)%20+%20%5Csigma%20%5Calpha%20%5Cleft(%5Cnabla%20f(x%5Ek)%5Cright)%5ET%20d%5Ek,"> mit <img src="https://latex.codecogs.com/png.latex?%5Csigma%5Cin%20(0,1)">. Die Armijo-Bedingung umgeht Konvergenzprobleme der einfachen Bedingung, indem sie fordert, dass die Verringerung zumindest proportional zur Schrittweite und zur Richtungsableitung <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cnabla%20f(x%5Ek)%5Cright)%5ET%20d%5Ek"> ist, mit Hilfe der Proportionalitätskonstante <img src="https://latex.codecogs.com/png.latex?%5Csigma">. In der Praxis werden oft sehr kleine Werte verwendet, z.B. <img src="https://latex.codecogs.com/png.latex?%5Csigma=0.0001">.</p>
<p>Die <em>Backtracking-Liniensuche</em> verringert die Schrittweite wiederholt um den Faktor <img src="https://latex.codecogs.com/png.latex?%5Crho"> (<code>rho</code>) , bis die Armijo-Bedingung erfüllt ist. Sie terminiert garantiert nach einer endlichen Anzahl von Schritten. Weshalb wir sie hier einsetzen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">alpha_k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1, d_k, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sigma =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0001</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rho =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) {</span>
<span id="cb14-2">  d_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_k[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb14-3">  d_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> d_k[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb14-4">  nabla <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nabla_qs</span>(b_0, b_1)</span>
<span id="cb14-5">  n_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nabla[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb14-6">  n_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nabla[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb14-7"></span>
<span id="cb14-8">  lhs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_0, b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_1)</span>
<span id="cb14-9">  rhs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(b_0, b_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(n_0<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_1)</span>
<span id="cb14-10"></span>
<span id="cb14-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (lhs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> rhs) {</span>
<span id="cb14-12">    alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rho <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> alpha</span>
<span id="cb14-13">    lhs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_0, b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_1)</span>
<span id="cb14-14">    rhs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(b_0, b_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sigma<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>alpha<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(n_0<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>d_1)</span>
<span id="cb14-15">  }</span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(alpha)</span>
<span id="cb14-17">}</span></code></pre></div>
</div>
<p>Ein paar Einstellungen vorab:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># maximale Anzahl an Iterationen</span></span>
<span id="cb15-2">max_iter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb15-3">iter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Genauigkeit</span></span>
<span id="cb15-6">eps <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Startwerte</span></span>
<span id="cb15-9">b_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> </span>
<span id="cb15-10">b_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> </span></code></pre></div>
</div>
<p>Für eine vorgegebene Genauigkeit <img src="https://latex.codecogs.com/png.latex?eps=10%5E%7B-6%7D">, den Startwerten <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0%5E0%20=%200"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1%5E0%20=%20-1"> können wir somit das Verfahren starten:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) {</span>
<span id="cb16-2">  iter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iter <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb16-3"></span>
<span id="cb16-4">  d_k <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nabla_qs</span>(b_0, b_1)</span>
<span id="cb16-5"></span>
<span id="cb16-6">  ad_ <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha_k</span>(b_0, b_1, d_k) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d_k</span>
<span id="cb16-7"></span>
<span id="cb16-8">  x0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ad_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb16-9">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ad_[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb16-10"></span>
<span id="cb16-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ((<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x0) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> eps) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> eps) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (iter <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_iter)) {</span>
<span id="cb16-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb16-13">  }</span>
<span id="cb16-14">  b_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x0</span>
<span id="cb16-15">  b_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x1</span>
<span id="cb16-16">}</span></code></pre></div>
</div>
<p>Wir haben in <img src="https://latex.codecogs.com/png.latex?203"> Iterationsschritten das folgende Ergebnis für die Regressionskoeffizienten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%5Cbeta_0%5E%7Bstud%7D%20=%200%20%5Cqquad%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20=%20-0.7761689%0A"></p>
<p>Betrachten wir die daraus erstellte Regressionsgerade:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-18-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Um die Regressionskoeffizienten für unser ursprüngliches Problem zu erhalten müssen wir wie folgt zurück rechnen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">(b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp))</span>
<span id="cb17-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.06822832</span></span>
<span id="cb17-3">(b0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  b1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp))</span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 30.09887</span></span></code></pre></div>
</div>
<p>Die Geradengleichung für das ursprüngliches Problem lautet somit:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.0988668%20-0.0682283%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.099%20-0.068%20%5Ccdot%20x%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="die-r-funktion-optim" class="level3">
<h3 class="anchored" data-anchor-id="die-r-funktion-optim">Die R Funktion <code>optim</code></h3>
<p>In <strong>R</strong> gibt es bessere Optimierungsmethoden, als die hier verwendete. Zum Beispiel können wir die Funktion <code>optim</code> verwenden. Die Funktion <code>optim</code> benötigt die zu optimierende <img src="https://latex.codecogs.com/png.latex?f(x)"> und ggf. die Gradientenfunktion <img src="https://latex.codecogs.com/png.latex?gf(x)"> sowie einen Startpunkt <img src="https://latex.codecogs.com/png.latex?x%5E0">:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(beta) {</span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb18-3">}</span>
<span id="cb18-4"></span>
<span id="cb18-5">grf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(beta) {</span>
<span id="cb18-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nabla_qs</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb18-7">}</span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Der eigentliche Aufruf von optim:</span></span>
<span id="cb18-10">ergb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optim</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),f ,grf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CG"</span>)</span>
<span id="cb18-11"></span>
<span id="cb18-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Auslesen der Schätzer aus dem Ergebnis:</span></span>
<span id="cb18-13">(optim_beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ergb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb18-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 0</span></span>
<span id="cb18-15">(optim_beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ergb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb18-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.7761683</span></span></code></pre></div>
</div>
<p>Wir erhalten somit für das studentisierte Problem die Gerade:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%5E%7Bstud%7D%20&amp;=%20%5Chat%5Cbeta_0%5E%7Bstud%7D%20+%20%5Chat%5Cbeta_1%5E%7Bstud%7D%20%5Ccdot%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%200%20-0.7761683%20%5Ccdot%20%20x%5E%7Bstud%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%200%20-0.776%20%5Ccdot%20%20x%5E%7Bstud%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>Für das ursprüngliche Problem rechnen wir mittels</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">optim_b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> optim_beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp)</span>
<span id="cb19-2">optim_b0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  optim_b1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp)</span></code></pre></div>
</div>
<p>um und erhalten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.0988601%20-0.0682283%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2030.099%20-0.068%20%5Ccdot%20x%0A%5Cend%7Baligned%7D%0A"></p>
</section>
</section>
<section id="idee-summe-der-absoluten-abweichungen" class="level2">
<h2 class="anchored" data-anchor-id="idee-summe-der-absoluten-abweichungen">2. Idee: Summe der absoluten Abweichungen</h2>
<p>Wir ändern nun die Abweichungsmessfunktion von der <em>Q</em>uadrat-<em>S</em>umme hin zu den <strong>A</strong>bsolut-<em>S</em>ummen:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AAS%20=%20AS(%5Chat%5Cbeta)%20=%20AS(%5Chat%5Cbeta_0,%20%5Chat%5Cbeta_1)%20=%20%5Csum_%7Bi=1%7D%5En%20%7C%5Chat%7By%7D_i%20-%20y_i%7C%0A"></p>
<p>Auch hier wollen wir mit den studentisierten Daten arbeiten und stellen die Funktion der <em>A</em>bsolut-<em>S</em>ummen auf:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Absolute Abweichungssummen</span></span>
<span id="cb20-2">as <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1) {</span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y)))</span>
<span id="cb20-4">}</span></code></pre></div>
</div>
<p>Danach konstruieren wir die zu optimierende Funktion <img src="https://latex.codecogs.com/png.latex?f">:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Zu optimierende Funktion</span></span>
<span id="cb21-2">f <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(beta) {</span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span>(beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], beta[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb21-4">}</span></code></pre></div>
</div>
<p>Diesmal nutzen wir <code>optim</code> ohne eine Gradientenfunktion:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">ergb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">optim</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), f)</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Schätzer auslesen</span></span>
<span id="cb22-4">(opti_as_beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ergb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.1304518</span></span>
<span id="cb22-6">(opti_as_beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ergb<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>par[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb22-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.6844911</span></span></code></pre></div>
</div>
<p>Schauen wir uns nun die so erhaltene Gerade im Vergleich mit der ‘normalen’ Regressionsgerade an:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-25-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>In grün und gestrichelt sehen wir die Gerade aus der <em>Idee der quadratischen Abweichungssummen</em>, in blau die aus der <em>Idee der absoluten Abweichungssummen</em>.</p>
<p>Für unser ursprüngliches Problem rechnen wir um:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Umrechnen in die ursprüngliche Fragestellung</span></span>
<span id="cb23-2">(as_b1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> opti_as_beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp))</span>
<span id="cb23-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] -0.06016948</span></span>
<span id="cb23-4">(as_b0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> as_b1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> opti_as_beta_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg))</span>
<span id="cb23-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; [1] 28.13051</span></span></code></pre></div>
</div>
<p>Und die dazu gehörige Darstellung:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/index_files/figure-html/unnamed-chunk-27-1.webp" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Die Funktionsvorschrift für die (blaue) Regressionsgerade lautet:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%5Chat%7By%7D%20&amp;=%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2028.1305094%20-0.0601695%20%5Ccdot%20x%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20&amp;%5Capprox%2028.131%20-0.06%20%5Ccdot%20x%0A%5Cend%7Baligned%7D%0A"></p>
<p>Diese Methode nennt sich <strong>Median-Regression</strong> und ein ein Spezialfall der <strong>Quantilsregression</strong>, die sich u.a. mit dem R-Paket <a href="https://cran.r-project.org/web/packages/quantreg/index.html"><em>quantreg</em></a> unmittelbar umsetzen lässt:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(quantreg)</span>
<span id="cb24-2">ergmedianreg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rq</span>(mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> hp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dt)</span>
<span id="cb24-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coef</span>(ergmedianreg)</span>
<span id="cb24-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; (Intercept)          hp </span></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 28.13050847 -0.06016949</span></span></code></pre></div>
</div>
</section>
<section id="idee-betrag-der-summe-der-abweichungen" class="level2">
<h2 class="anchored" data-anchor-id="idee-betrag-der-summe-der-abweichungen">1. Idee: Betrag der Summe der Abweichungen</h2>
<p>Wenn wir die Summe der Abweichungen <img src="https://latex.codecogs.com/png.latex?%5Csum%5Climits_%7Bi=1%7D%5En%20%5Chat%7Be%7D_i"> minimieren wollen, dann ist es sinnvoll den Betrag davon zu minimieren. Wir suchen also die Schätzer <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1">, so dass der Ausdruck</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%7C%20%5Csum_%7Bi=1%7D%5En%20%5Chat%7Be%7D_i%20%5Cright%7C%20=%20%5Cleft%7C%20%5Csum_%7Bi=1%7D%5En%20(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i)%20%5Cright%7C%0A"></p>
<p>minimal ist.</p>
<p>Wegen:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20(%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20y_i)%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Chat%5Cbeta_0%20+%20%5Csum_%7Bi=1%7D%5En%20%5Chat%5Cbeta_1%20%5Ccdot%20x_i%20-%20%5Csum_%7Bi=1%7D%5En%20y_i%20%5C%5C%0A&amp;=%20n%20%5Ccdot%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Csum_%7Bi=1%7D%5En%20x_i%20-%20%5Csum_%7Bi=1%7D%5En%20y_i%20%5C%5C%0A&amp;=%20n%20%5Ccdot%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20n%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20n%20%5Ccdot%20%5Cbar%7By%7D%20%5C%5C%0A&amp;=%20n%20%5Ccdot%20%5Cleft(%20%5Chat%5Cbeta_0%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20-%20%5Cbar%7By%7D%20%5Cright)%20%5C%5C%0A&amp;=%20n%20%5Ccdot%20%5Cleft(%20%5Chat%5Cbeta_0%20-%20%5Cbar%7By%7D%20+%20%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D%20%20%5Cright)%0A%5Cend%7Baligned%7D%0A"></p>
<p>können wir das absolute Minimum bei <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0%20-%20%5Cbar%7By%7D%20=0"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1%20%5Ccdot%20%5Cbar%7Bx%7D=0"> erreichen, was zur Lösung <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_0%20=%5Cbar%7By%7D"> und <img src="https://latex.codecogs.com/png.latex?%5Chat%5Cbeta_1%20=%200"> führt. Dies ist unser <em>Nullmodel</em> in dem die <img src="https://latex.codecogs.com/png.latex?x_i"> keinen Einfluss auf die <img src="https://latex.codecogs.com/png.latex?y_i"> haben und wir daher pauschal die <img src="https://latex.codecogs.com/png.latex?y_i"> mit <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_i=%5Cbar%7By%7D">, also dem Mittelwert der <img src="https://latex.codecogs.com/png.latex?y_i"> abschätzen.</p>
</section>
<section id="zusammenfassung" class="level2">
<h2 class="anchored" data-anchor-id="zusammenfassung">Zusammenfassung</h2>
<p>Als Vergleich können wir uns die Quadratsumme <img src="https://latex.codecogs.com/png.latex?QS"> und Absolutsumme <img src="https://latex.codecogs.com/png.latex?AS"> der drei Modelle einmal ansehen:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quadratische Abweichungssummen</span></span>
<span id="cb25-2">qs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1) {</span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(((b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb25-4">}</span>
<span id="cb25-5"></span>
<span id="cb25-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Absolute Abweichungssummen</span></span>
<span id="cb25-7">as <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b_0, b_1) {</span>
<span id="cb25-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>((b_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hp) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> dt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mpg))</span>
<span id="cb25-9">}</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quadratsummen:</span></span>
<span id="cb26-2">quad_sum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(b0, b1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(as_b0, as_b1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qs</span>(mean_mpg, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Absolutsummen:</span></span>
<span id="cb26-5">abs_sum <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span>(b0, b1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span>(as_b0, as_b1), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as</span>(mean_mpg, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb26-6"></span>
<span id="cb26-7">tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb26-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sums =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(quad_sum, abs_sum),</span>
<span id="cb26-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quad"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"abs"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb26-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methode =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idee 3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idee 2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Idee 1"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-11">)</span>
<span id="cb26-12"></span>
<span id="cb26-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(tab, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from=</span>sum_type, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from=</span>sums, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sort=</span>T)</span>
<span id="cb26-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; # A tibble: 3 × 3</span></span>
<span id="cb26-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   methode   abs  quad</span></span>
<span id="cb26-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb26-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 1 Idee 3   93.0  448.</span></span>
<span id="cb26-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 2 Idee 2   87.3  477.</span></span>
<span id="cb26-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#&gt; 3 Idee 1  151.  1126.</span></span></code></pre></div>
</div>
</section>
<section id="reproduzierbarkeitsinformationen" class="level2">
<h2 class="anchored" data-anchor-id="reproduzierbarkeitsinformationen">Reproduzierbarkeitsinformationen</h2>
<div class="cell" data-layout-align="center">
<pre><code>#&gt; R version 4.5.1 (2025-06-13)
#&gt; Platform: aarch64-apple-darwin20
#&gt; Running under: macOS Sequoia 15.5
#&gt; 
#&gt; Locale: en_US.UTF-8 / en_US.UTF-8 / en_US.UTF-8 / C / en_US.UTF-8 / en_US.UTF-8
#&gt; 
#&gt; Package version:
#&gt;   mosaic_1.9.1 quantreg_6.1 tidyr_1.3.1  xfun_0.52</code></pre>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p>Das “Cookbook” zur Datentabelle können Sie mit Hilfe von <code>help("mtcars")</code> aufrufen!↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-06-09-ueber-die-koeffizienten-einer-linearen-regression/</guid>
  <pubDate>Tue, 08 Jun 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>GraalPy , PyPy und (C)Python im kurzen Geschwindigkeitstest</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-04-08-graalpy-pypy--und-python-geschwindigkeitstest/</link>
  <description><![CDATA[ 





<section id="kleiner-geschwindigkeitstest-mit-python3-pypy-und-graalpython" class="level2">
<h2 class="anchored" data-anchor-id="kleiner-geschwindigkeitstest-mit-python3-pypy-und-graalpython">Kleiner Geschwindigkeitstest mit Python3, PyPy und GraalPython</h2>
<p>Heute habe ich mit Hilfe von Pyenv einen kompakten Performance-Vergleich zwischen (C)Python3, PyPy und GraalPython durchgeführt.</p>
<p>Als Testfall diente das klassische n-Damen-Problem, dessen Lösungsalgorithmus ich als Basis verwendet habe.</p>
<p>Den Quellcode findet man hier: <a href="https://github.com/sol-prog/N-Queens-Puzzle" class="uri">https://github.com/sol-prog/N-Queens-Puzzle</a></p>
<section id="die-ergebnisse-des-test-vom-8.4.2021" class="level3">
<h3 class="anchored" data-anchor-id="die-ergebnisse-des-test-vom-8.4.2021">Die Ergebnisse des Test vom 8.4.2021</h3>
<ul>
<li>CPython (3.9.4): Calculation took 316.97 seconds</li>
<li>PyPy (3.7-7.3.3): Calculation took 10.14 seconds</li>
<li>GraalPython (21.0.0): Calculation took 15.75 seconds</li>
</ul>
</section>
</section>
<section id="neues-setup" class="level2">
<h2 class="anchored" data-anchor-id="neues-setup">Neues Setup</h2>
<p>Die Ergebnisse für n = 11 wurden mit der Zeile</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> timeit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> 50 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 ‘import nqueens<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nqueens.main()</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">’</span></span></code></pre></div>
<p>erzeugt.</p>
<!-- Unglaubwürdige Ergebnisse!!!

### Die Ergebnisse des Test vom 8.6.2021

- CPython (3.9.4): 1 loops, best of 5: 7.03 sec per loop
- PyPy (3.7-7.3.4): ***keine Ergebnisse***
- GraalPython (21.1.0): 1 loops, best of 5: 7.01 sec per loop

-->
<section id="die-ergebnisse-des-test-vom-20.7.2025" class="level3">
<h3 class="anchored" data-anchor-id="die-ergebnisse-des-test-vom-20.7.2025">Die Ergebnisse des Test vom 20.7.2025</h3>
<ul>
<li>CPython:
<ul>
<li>3.13.1: 1 loop, best of 50: 673 msec per loop</li>
<li>3.13.5: 1 loop, best of 50: 661 msec per loop</li>
</ul></li>
<li>PyPy:
<ul>
<li>3.10-7.3.17: 1 loops, average of 50: 75.6 +- 2.9 msec per loop (using standard deviation)</li>
<li>3.11-7.3.19: 1 loops, average of 50: 74.9 +- 2.89 msec per loop (using standard deviation)</li>
</ul></li>
<li>GraalPython/GraalPy
<ul>
<li>GraalPy 3.11.7 (Oracle GraalVM Native 24.1.1):1 loop, best of 50: 24.9 msec per loop</li>
<li>GraalPy 3.11.7 (GraalVM CE Native 24.1.1): 1 loop, best of 50: 30 msec per loop</li>
<li>GraalPy 3.11.7 (Oracle GraalVM Native 24.2.1): 1 loop, best of 50: 24.5 msec per loop</li>
<li>GraalPy 3.11.7 (GraalVM CE Native 24.2.1): 1 loop, best of 50: 28.1 msec per loop</li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>Python</category>
  <category>PyPy</category>
  <category>GraalPython</category>
  <category>GraalPy</category>
  <category>Speedtest</category>
  <guid>https://www.sefiroth.de/posts/2021-04-08-graalpy-pypy--und-python-geschwindigkeitstest/</guid>
  <pubDate>Wed, 07 Apr 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Über die t-Verteilung mit einem bzw. zwei Freiheitsgraden</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/</link>
  <description><![CDATA[ 





<section id="vorbereitungen-für-r" class="level2">
<h2 class="anchored" data-anchor-id="vorbereitungen-für-r">Vorbereitungen für R</h2>
<p>Für die graphischen Ausgaben nutzen wir R und das Paket <code>mosaic</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span></code></pre></div>
</div>
</section>
<section id="vorbemerkungen-und-notationen" class="level2">
<h2 class="anchored" data-anchor-id="vorbemerkungen-und-notationen">Vorbemerkungen und Notationen</h2>
<p>Da alle t-Verteilungen symmetrisch sind, betrachten wir im wesendlichen nur den positiven Teil.</p>
<p>Zwei reelle Funktionen <img src="https://latex.codecogs.com/png.latex?f">, <img src="https://latex.codecogs.com/png.latex?g"> sind genau dann, im Sinne von de Bruijn<sup>1</sup> (§1.4), <strong>asymptotisch äquivalent</strong> <img src="https://latex.codecogs.com/png.latex?f%20%5Csim%20g">, wenn</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7Bf(x)%7D%7Bg(x)%7D%20=%201%0A"></p>
<p>gilt.</p>
<p>Ist <img src="https://latex.codecogs.com/png.latex?f%20%5Csim%20g">, so können wir auch</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20g(x)%5Ccdot(1+o(1))%0A"></p>
<p>dafür schreiben. Dabei ist <img src="https://latex.codecogs.com/png.latex?h(x)%20=%20o(%5Cphi(x))"> für <img src="https://latex.codecogs.com/png.latex?x%20%5Cto%20%5Cinfty">, falls <img src="https://latex.codecogs.com/png.latex?%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7Bh(x)%7D%7B%5Cphi(x)%7D%20=%200"> gilt. Aus der asymptotischen Äquivalenz von <img src="https://latex.codecogs.com/png.latex?f"> und <img src="https://latex.codecogs.com/png.latex?g"> folgt nun direkt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%5Cfrac%7Bf(x)%7D%7Bg(x)%7D-1%20=%5Cfrac%7Bf(x)-g(x)%7D%7Bg(x)%7D%20=%200%0A"></p>
<p>Mit <img src="https://latex.codecogs.com/png.latex?h(x)%20=%20%5Cfrac%7Bf(x)-g(x)%7D%7Bg(x)%7D"> ist <img src="https://latex.codecogs.com/png.latex?h(x)%20=%20o(1)"> und daher <img src="https://latex.codecogs.com/png.latex?f(x)-g(x)%20=%20g(x)o(1)"> und schliesslich <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20g(x)+g(x)o(1)">.</p>
<p>Ein wichtiges Korrolar sagt:</p>
<p>Ist <img src="https://latex.codecogs.com/png.latex?f%20%5Csim%20g">, so ist auch <img src="https://latex.codecogs.com/png.latex?%5Clog(f)%20%5Csim%20%5Clog(g)">.</p>
</section>
<section id="die-t-verteilung-im-allgemeinen" class="level2">
<h2 class="anchored" data-anchor-id="die-t-verteilung-im-allgemeinen">Die t-Verteilung im Allgemeinen</h2>
<p>Die Dichtefunktion der t-Verteilung lauten im Allgemeinen:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_n(x)%20=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7Bn+1%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7Bn%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7Bn%7D%7B2%7D%5Cright)%7D%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7Bn%7D%5Cright)%5E%7B-%5Cfrac%7Bn+1%7D%7B2%7D%7D%5Cquad%20%5Cmathrm%7Bf%C3%BCr%7D%5Cquad%20-%5Cinfty%20%3C%20x%20%3C%20+%5Cinfty%0A"></p>
<p>wobei wir mit <img src="https://latex.codecogs.com/png.latex?%5CGamma(x)"> die Gammafunktion</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CGamma(x)=%5Cint%5Climits_%7B0%7D%5E%7B+%5Cinfty%7Dt%5E%7Bx-1%7De%5E%7B-t%7D%5Coperatorname%7Bd%7Dt%0A"></p>
<p>bezeichnen. Für einige <img src="https://latex.codecogs.com/png.latex?x"> nimmt die Gammafunktion leicht zu berechnende Werte an:</p>
<p>So ist für alle <img src="https://latex.codecogs.com/png.latex?n%5Cin%5Cmathbf%7BN_0%7D">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5CGamma(n+1)%20=%20n!"> und <img src="https://latex.codecogs.com/png.latex?%5CGamma%5Cleft(n%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cright)%20=%20%5Cfrac%7B(2n)!%7D%7Bn!4%5En%7D%5Csqrt%7B%5Cpi%7D"></p>
<p>mit der gewöhnlichen Fakultät <img src="https://latex.codecogs.com/png.latex?n!%20=%20%5Cprod_%7Bi=0%7D%5En%20i">, wobei per Definition <img src="https://latex.codecogs.com/png.latex?0!=1"> ist.</p>
</section>
<section id="die-t-verteilung-mit-einem-freiheitsgrad" class="level2">
<h2 class="anchored" data-anchor-id="die-t-verteilung-mit-einem-freiheitsgrad">Die t-Verteilung mit einem Freiheitsgrad</h2>
<p>Für <img src="https://latex.codecogs.com/png.latex?f_1(x)"> ergibt sich somit:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af_1(x)%20&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7Bn+1%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7Bn%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7Bn%7D%7B2%7D%5Cright)%7D%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7Bn%7D%5Cright)%5E%7B-%5Cfrac%7Bn+1%7D%7B2%7D%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7B2%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7B%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7B1%7D%7B2%7D%5Cright)%7D%5Cleft(1+x%5E%7B2%7D%5Cright)%5E%7B-%5Cfrac%7B2%7D%7B2%7D%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(1%5Cright)%7D%20%7B%5Csqrt%7B%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7B1%7D%7B2%7D%5Cright)%7D%5Cleft(1+x%5E%7B2%7D%5Cright)%5E%7B-1%7D%20%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Wegen <img src="https://latex.codecogs.com/png.latex?%5CGamma(1)%20=%200!%20=%201"> und <img src="https://latex.codecogs.com/png.latex?%5CGamma%5Cleft(%5Cfrac%7B1%7D%7B2%7D%5Cright)=%5Csqrt%7B%5Cpi%7D"> ergibt sich nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af_1(x)%20&amp;=%20%5Cfrac%7B1%7D%20%7B%5Csqrt%7B%5Cpi%7D%20%5Ccdot%20%5Csqrt%7B%5Cpi%7D%7D%20%5Ccdot%20%5Cleft(1+x%5E%7B2%7D%5Cright)%5E%7B-1%7D%20%5C%5C%0A%20%20%20%20%20%20%20&amp;=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cfrac%7B1%7D%7B1+x%5E%7B2%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Das ist die Dichtefunktion der standardisierten Cauchy-Verteilung</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_%7B(%5Cmu,%5Clambda)%7D(x)%20=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cfrac%7B%5Clambda%7D%7B%5Clambda%5E2+(x-%5Cmu)%5E2%7D%0A"></p>
<p>mit (<img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200"> und <img src="https://latex.codecogs.com/png.latex?%5Clambda=1">), welche – bekanntermaßen – keinen Erwartungwert hat.</p>
<p>Wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7Bf_1(k%20%5Ccdot%20x)%7D%7Bf_1(x)%7D%0A%20%20%20%20%20%20&amp;=%20%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cfrac%7B1%7D%7B1+(kx)%5E%7B2%7D%7D%7D%7B%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cfrac%7B1%7D%7B1+x%5E%7B2%7D%7D%7D%20=%20%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B1+x%5E2%7D%7B1+k%5E2x%5E2%7D%20%5C%5C%0A%20%20%20%20%20%20&amp;=%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bx%5E2%7D+%5Cfrac%7Bx%5E2%7D%7Bx%5E2%7D%7D%7B%5Cfrac%7B1%7D%7Bx%5E2%7D+k%5E2%5Cfrac%7Bx%5E2%7D%7Bx%5E2%7D%7D%20=%5Cfrac%7B1%7D%7Bk%5E2%7D=k%5E%7B-2%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>für alle reellen <img src="https://latex.codecogs.com/png.latex?k%3E0"> ist <img src="https://latex.codecogs.com/png.latex?f_1(x)"> eine regulär variierende Funktion mit Variationsindex <img src="https://latex.codecogs.com/png.latex?%5Crho%20=%20-2">.</p>
<p>Die Überlebensfunktion zur t-Verteilung mit einem Freiheitsgrad lautet nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Coverline%7BF%7D_1(x)%20=%20%5Cint_x%5E%5Cinfty%20f_1(t)%20%5Coperatorname%7Bd%7Dt%20=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cint_x%5E%5Cinfty%20%20%5Cfrac%7B1%7D%7B1+x%5E%7B2%7D%7D%20%5Coperatorname%7Bd%7Dt%20=%20%5Cfrac%7B%5Carctan(x)%7D%7B%5Cpi%7D%0A"></p>
<p>da wir das optionale <img src="https://latex.codecogs.com/png.latex?+C"> mit <img src="https://latex.codecogs.com/png.latex?C=0"> annehmen dürfen.</p>
<p>Es gilt nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Carctan%60(x)=%20%5Cfrac%7B1%7D%7B1+x%5E2%7D%20%5Cto%20%5Cfrac%7B1%7D%7Bx%5E2%7D%20%5Ctext%7B%20f%C3%BCr%20%7D%20x%5Cto%20%5Cinfty%0A"></p>
<p>Genauer gilt wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B%5Cfrac%7B1%7D%7B1+x%5E2%7D%7D%7B%5Cfrac%7B1%7D%7Bx%5E2%7D%7D%0A=%20%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7Bx%5E2%7D%7B1+x%5E2%7D%20=1,%0A"></p>
<p>dass <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B1+x%5E2%7D%20%5Csim%20%5Cfrac%7B1%7D%7Bx%5E2%7D">, also asymptotisch äquivalent sind und somit auch <img src="https://latex.codecogs.com/png.latex?%5Clog%5Cleft(%5Cfrac%7B1%7D%7B1+x%5E2%7D%5Cright)%20%5Csim%20%5Clog%5Cleft(%5Cfrac%7B1%7D%7Bx%5E2%7D%5Cright)">.</p>
<p>Zusammen gefasst gilt somit: <img src="https://latex.codecogs.com/png.latex?%0A%5Clog%5Cleft(%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cfrac%7B1%7D%7B1+x%5E%7B2%7D%7D%5Cright)%20%5Cto%20-2%5Clog(x)%20-%20%5Clog(%5Cpi)%20%5Ctext%7B%20f%C3%BCr%20%7D%20x%20%5Cto%20%5Cinfty%0A"></p>
<p>Sei <img src="https://latex.codecogs.com/png.latex?f_1%5E*(x)%20=%20C%20%5Ccdot%20x%5E%7B-%5Calpha%7D"> mit <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%202"> und <img src="https://latex.codecogs.com/png.latex?C=%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Capprox0.3183">.</p>
<p>Schauen wir uns das einmal als Grafik an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-3">dfree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-4"></span>
<span id="cb2-5">f_star <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-6">  alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-7">  C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi</span>
<span id="cb2-8">  C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha)</span>
<span id="cb2-9">}</span>
<span id="cb2-10"></span>
<span id="cb2-11">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(lower_bound, upper_bound, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb2-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb2-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f_star</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb2-17">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-2-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Hier eine doppelt-logarithmische Darstellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb3-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb3-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f_star</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb3-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb3-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb3-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb3-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-3-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Wie groß ist nun der (absolute) Fehler zwischen <img src="https://latex.codecogs.com/png.latex?f_1%5E*"> und <img src="https://latex.codecogs.com/png.latex?f_1">?</p>
<p>Eine Grafik von <img src="https://latex.codecogs.com/png.latex?f_1%5E*-f_1"> zeigt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb4-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb4-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb4-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb4-7">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-4-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Genauer gilt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_1%5E*(x)%20-%20f_1(x)%20=%20%5Cfrac%7B1%7D%7Bx%5E2+x%5E4%7D%0A"></p>
<p>Wir können also für ein hinreichend großes <img src="https://latex.codecogs.com/png.latex?x%20%3E%3E%201"> statt <img src="https://latex.codecogs.com/png.latex?f_1"> auch <img src="https://latex.codecogs.com/png.latex?f_1%5E*"> verwenden und erhalten somit:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Coverline%7BF%7D_1(x)%20&amp;%5Capprox%20%5Cint_x%5E%5Cinfty%20f_1%5E*(t)%20%5Coperatorname%7Bd%7Dt%0A%20%20=%20%5Cint_x%5E%5Cinfty%20%20C%20%5Ccdot%20t%5E%7B-%5Calpha%7D%20%5Coperatorname%7Bd%7Dt%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%20%5Ccdot%20%5Cint_x%5E%5Cinfty%20%20t%5E%7B-2%7D%20%5Coperatorname%7Bd%7Dt%0A%20%20=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%5Cleft%5B%5Clim%5Climits_%7B%5Cepsilon%20%5Cto%20%5Cinfty%7D%20%5Cleft(-%5Cepsilon%5E%7B-1%7D%5Cright)%20-%5Cleft(-x%5E%7B-1%7D%5Cright)%5Cright%5D%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B1%7D%7B%5Cpi%7D%5Ccdot%5Cleft%5B0%20+%20%5Cfrac%7B1%7D%7Bx%7D%5Cright%5D%20=%20%5Cfrac%7B1%7D%7B%5Cpi%20%5Ccdot%20x%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p><strong>Wie hinreichend ist hier hinreichend groß?</strong></p>
<p>Taleb schreibt an dieser Stelle gerne, dass man jenseits des <em>Karamata-Punktes</em> die <em>Karamata-Konstante</em> anwenden kann. Beides Begriffe, zu denen ich zunächst keine echte Definition gefunden habe.</p>
<p><a href="https://de.wikipedia.org/wiki/Jovan_Karamata">Jovan Karamata</a> ist der Begründer der langsam variierend Funktionen. 1930 zeite er, dass eine positive stetige Funktion <img src="https://latex.codecogs.com/png.latex?L"> auf den positiven reellen Zahlen genau dann langsam variierend ist, also für alle <img src="https://latex.codecogs.com/png.latex?t%20%3E%200"> die Bedingung</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(t%5C,x)/L(x)%20%5Cto%201%20%5Cqquad%5Ctext%7Bf%C3%BCr%7D%5Cqquad%20x%20%5Cto%20%5Cinfty%0A"></p>
<p>erfüllt, wenn sie für ein <img src="https://latex.codecogs.com/png.latex?a%20%3E%200"> für <img src="https://latex.codecogs.com/png.latex?x%20%3E%20a"> in der Form</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AL(x)%20=%20c(x)%20%5Ccdot%20%5Cexp%20%5Cleft(%5Cint_a%5Ex%5C!%5Cvarepsilon(t)/t%20%5C%20dt%20%5Cright)%0A"> mit <img src="https://latex.codecogs.com/png.latex?c(x)%20%5Cto%20c%20%3E%200"> und <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon(x)%20%5Cto%200"> für <img src="https://latex.codecogs.com/png.latex?x%20%5Cto%20%5Cinfty"> geschrieben werden kann.</p>
<p>Ich vermute also, dass wir <img src="https://latex.codecogs.com/png.latex?L(x)"> ab dem Punkt <img src="https://latex.codecogs.com/png.latex?a"> näherungsweise durch <img src="https://latex.codecogs.com/png.latex?c(x)"> besser sogar durch die Konstante <img src="https://latex.codecogs.com/png.latex?c"> ersetzen könnten.</p>
<p>Die <em>Karamata-Konstante</em> ist <img src="https://latex.codecogs.com/png.latex?%5Crho%20=%20-%5Calpha">, also <img src="https://latex.codecogs.com/png.latex?%5Crho%20=%20c">?</p>
<p>Der <em>Karamata-Punkt</em> bleibt etwas nebulöser. Es könnte sich hier um den Punkt <img src="https://latex.codecogs.com/png.latex?a"> handeln und vermutlich könnte man hier so argumentieren:</p>
<p>Wenn die Fehler zwischen <img src="https://latex.codecogs.com/png.latex?f"> und <img src="https://latex.codecogs.com/png.latex?f%5E*"> hinreichend klein ist.</p>
<p>Hierfür könnte man einen absoluten Fehler oder einen relativen Fehler als Maßstab ansehen.</p>
<p>Für einen relativen Fehler vielleicht <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bf%5E*-f%7D%7Bx%7D%20%3C%20k">?</p>
<p>Oder man betrachtet hier gleich <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bf%5E*-f%7D%7B%5Clog(x)%7D%20%3C%20k%5E*">?</p>
</section>
<section id="t-verteilung-mit-zwei-freiheitsgeraden" class="level2">
<h2 class="anchored" data-anchor-id="t-verteilung-mit-zwei-freiheitsgeraden">t-Verteilung mit zwei Freiheitsgeraden</h2>
<p>Für <img src="https://latex.codecogs.com/png.latex?f_2(x)"> ergibt sich somit:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af_2(x)%20&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7Bn+1%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7Bn%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7Bn%7D%7B2%7D%5Cright)%7D%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7Bn%7D%5Cright)%5E%7B-%5Cfrac%7Bn+1%7D%7B2%7D%7D%20%5C%5C%0A%20%20%20%20%20%20%20&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7B3%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7B2%5Cpi%7D~%5CGamma%5Cleft(%5Cfrac%7B2%7D%7B2%7D%5Cright)%7D%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7B2%7D%5Cright)%5E%7B-%5Cfrac%7B3%7D%7B2%7D%7D%20%5C%5C%0A%20%20%20%20%20%20%20&amp;=%20%5Cfrac%7B%5CGamma%5Cleft(%5Cfrac%7B3%7D%7B2%7D%5Cright)%7D%20%7B%5Csqrt%7B2%5Cpi%7D~%5CGamma%5Cleft(1%5Cright)%7D%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7B2%7D%5Cright)%5E%7B-%5Cfrac%7B3%7D%7B2%7D%7D%20%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Wegen <img src="https://latex.codecogs.com/png.latex?%5CGamma(1)%20=%200!%20=%201"> und <img src="https://latex.codecogs.com/png.latex?%5CGamma%5Cleft(%5Cfrac%7B3%7D%7B2%7D%5Cright)=%5Cfrac%7B%5Csqrt%7B%5Cpi%7D%7D%7B2%7D"> ergibt sich nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af_2(x)%20&amp;=%20%5Cfrac%7B1%7D%7B2%5Csqrt%7B2%7D%7D%20%5Ccdot%20%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7B2%7D%5Cright)%5E%7B-%5Cfrac%7B3%7D%7B2%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%5B2%5D%7B2%5E3%7D%20%5Ccdot%20%5Csqrt%5B2%5D%7B%5Cleft(1+%5Cfrac%7Bx%5E%7B2%7D%7D%7B2%7D%5Cright)%5E3%7D%7D%20%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B1%7D%7B(x%5E2+2)%5E%7B%5Cfrac%7B3%7D%7B2%7D%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B(x%5E2+2)%5E3%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7Bf_2(k%20%5Ccdot%20x)%7D%7Bf_2(x)%7D%0A%20%20%20%20&amp;=%20%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B%5Cfrac%7B1%7D%7B%5Csqrt%7B((k%5Ccdot%20x)%5E2+2)%5E3%7D%7D%7D%7B%5Cfrac%7B1%7D%7B%5Csqrt%7B(x%5E2+2)%5E3%7D%7D%7D%20=%20%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B%5Csqrt%7B(x%5E2+2)%5E3%7D%7D%7B%5Csqrt%7B((k%5Ccdot%20x)%5E2+2)%5E3%7D%7D%20%5C%5C%0A%20%20%20%20&amp;=%20%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cleft(%5Cfrac%7Bx%5E2+2%7D%7Bk%5E2x%5E2+2%7D%5Cright)%5E%5Cfrac%7B3%7D%7B2%7D=%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cleft(%5Cfrac%7B%5Cfrac%7Bx%5E2%7D%7Bx%5E2%7D+%5Cfrac%7B2%7D%7Bx%5E2%7D%7D%7Bk%5E2%5Cfrac%7Bx%5E2%7D%7Bx%5E2%7D+%5Cfrac%7B2%7D%7Bx%5E2%7D%7D%5Cright)%5E%5Cfrac%7B3%7D%7B2%7D%20%5C%5C%0A%20%20%20%20&amp;=%5Cleft(%5Cfrac%7B1%7D%7Bk%5E2%7D%5Cright)%5E%5Cfrac%7B3%7D%7B2%7D=%5Cfrac%7B1%7D%7Bk%5E3%7D=k%5E%7B-3%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>für alle reellen <img src="https://latex.codecogs.com/png.latex?k%3E0"> ist <img src="https://latex.codecogs.com/png.latex?f_2(x)"> eine regulär variierende Funktion mit Variationsindex <img src="https://latex.codecogs.com/png.latex?%5Crho%20=%20-3">.</p>
<p>Die Überlebensfunktion zur t-Verteilung mit einem Freiheitsgrad lautet nun:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Coverline%7BF%7D_2(x)%20&amp;=%20%5Cint_x%5E%5Cinfty%20f_2(t)%20%5Coperatorname%7Bd%7Dt%20=%20%5Cint_x%5E%5Cinfty%20%5Cfrac%7B1%7D%7B%5Csqrt%7B(t%5E2+2)%5E3%7D%7D%20%5Coperatorname%7Bd%7Dt%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bx%7D%7B2%20%5Ccdot%20%5Csqrt%7Bx%5E2+2%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>da wir das optionale <img src="https://latex.codecogs.com/png.latex?+C"> mit <img src="https://latex.codecogs.com/png.latex?C=0"> annehmen dürfen.</p>
<p>Es gilt für jedes feste <img src="https://latex.codecogs.com/png.latex?k%3E0">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B%5Coverline%7BF%7D_2(k%20x)%7D%7B%5Coverline%7BF%7D_2(x)%7D%20&amp;=%20%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7Dk%20%5Ccdot%20%5Csqrt%7B%5Cfrac%7Bx%5E2+2%7D%7Bk%5E2x%5E2+2%7D%7D%20%5C%5C%0A%20%20&amp;=%20%20k%20%5Ccdot%20%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%20%5Csqrt%7B%5Cfrac%7B1%7D%7Bk%5E2%7D%20%5Ccdot%20%5Cfrac%7Bx%5E2+2%7D%7Bx%5E2+%5Cfrac%7B2%7D%7Bk%5E2%7D%7D%7D%20%5C%5C%0A%20%20&amp;=%20%5Cfrac%7Bk%7D%7Bk%7D%20%5Ccdot%20%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%20%5Csqrt%7B%20%5Cfrac%7Bx%5E2+2%7D%7Bx%5E2+%5Cfrac%7B2%7D%7Bk%5E2%7D%7D%7D%20=%201%5Cend%7Balign*%7D%0A"></p>
<p>Wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B%5Cfrac%7B1%7D%7B%5Csqrt%7B(x%5E2+2)%5E3%7D%7D%7D%7B%5Cfrac%7B1%7D%7Bx%5E3%7D%7D%20=%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7Bx%5E3%7D%7B(%5Csqrt%7Bx%5E2+2%7D)%5E3%7D%20=%20%5Clim%5Climits_%7Bx%20%5Cto%20%5Cinfty%7D%20%5Cleft(%5Cfrac%7Bx%7D%7B%5Csqrt%7Bx%5E2+2%7D%7D%5Cright)%5E3=%201%0A"></p>
<p>ist <img src="https://latex.codecogs.com/png.latex?f_2%20%5Csim%20f%5E*_2"> und somit auch <img src="https://latex.codecogs.com/png.latex?%5Clog(f_2)%20%5Csim%20%5Clog(f%5E*_2)">.</p>
<p>Aus <img src="https://latex.codecogs.com/png.latex?%5Clog%5Cleft(%5Cfrac%7B1%7D%7Bx%5E3%7D%5Cright)%20=%20%5Clog(1)-%203%5Ccdot%5Clog(x)"> können wir daher auf <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%203"> und <img src="https://latex.codecogs.com/png.latex?C=1"> schliesse und schreiben:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_2%5E*(x)%20=%20C%20%5Ccdot%20x%5E%7B-%5Calpha%7D%20=%20x%5E%7B-3%7D%0A"></p>
<p>Schauen wir uns das einmal als Grafik an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-3">dfree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-4"></span>
<span id="cb5-5">f_star <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb5-6">  alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb5-7">  C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-8">  C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha)</span>
<span id="cb5-9">}</span>
<span id="cb5-10"></span>
<span id="cb5-11">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(lower_bound, upper_bound, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb5-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb5-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f_star</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb5-17">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Hier eine doppelt-logarithmische Darstellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb6-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb6-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f_star</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb6-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb6-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb6-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb6-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-6-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
<p>Wie groß ist nun der absolute Fehler zwischen <img src="https://latex.codecogs.com/png.latex?f_2%5E*"> und <img src="https://latex.codecogs.com/png.latex?f_2"> genau?</p>
<p>Eine Grafik zeigt von <img src="https://latex.codecogs.com/png.latex?f_2%5E*-2_1"> zeigt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">f_star</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dt</span>(x,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb7-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb7-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb7-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb7-7">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/index_files/figure-html/unnamed-chunk-7-1.webp" class="img-fluid figure-img" width="384"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fussnoten" class="level2">
<h2 class="anchored" data-anchor-id="fussnoten">Fussnoten</h2>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p><a href="https://de.wikipedia.org/wiki/Nicolaas_Govert_de_Bruijn">de Bruijn, N. G.</a> (1981), <a href="https://books.google.com/books?id=Oqj9AgAAQBAJ">Asymptotic Methods in Analysis</a>, Dover Publications, ISBN 9780486642215↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-02-14-ueber-die-t-verteilung-mit-einem-bzw-zwei-freiheitsgraden/</guid>
  <pubDate>Tue, 16 Feb 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Behäbige Funktionen aka slowly varying function</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-02-13-behaebige-funktionen-aka-slowly-varying-function/</link>
  <description><![CDATA[ 





<p>Reelle Funktionen, die ihren Funktionswert kaum ändern, kann man mit Fug und Recht durchaus behäbig nennen, korrekter wäre aber von <strong>langsam variierenden</strong> Funktionen zu sprechen</p>
<p>Im Kontext von potenzgesetzlichen Verteilungen kommt der Begriff <strong>slowly varying function</strong> vor, der Funktionen beschreibt die nur sehr gering auf Änderungen ihres Parameters reagieren.</p>
<p>Die Definition dieser <em>behäbigen</em> besser <strong>langsam variierenden</strong> Funktionen stammt von <a href="https://de.wikipedia.org/wiki/Jovan_Karamata">Jovan Karamata</a>:</p>
<p>Eine positive stetige Funktion <img src="https://latex.codecogs.com/png.latex?L"><sup>1</sup> auf den positiven reelen Zahlen ist <strong>langsam variierend (im unendlichen)</strong>, falls für alle reellen <img src="https://latex.codecogs.com/png.latex?t%3E0"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7BL(t%5Ccdot%20x)%7D%7BL(x)%7D%20=%201"></p>
<p>gilt.</p>
<p><strong>Beispiele:</strong></p>
<ol type="1">
<li>Jede konstante Funktionen (<img src="https://latex.codecogs.com/png.latex?%5Cneq%200">) ist <em>langsam variierend</em>.</li>
</ol>
<p><strong>Beweisskizze:</strong> Mit <img src="https://latex.codecogs.com/png.latex?L(x)%20=%20c"> ist <img src="https://latex.codecogs.com/png.latex?L(x)%20=%20L(t%20x)%20=%20c"> und damit <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BL(t%20x)%7D%7BL(x)%7D=%201">.</p>
<ol start="2" type="1">
<li>Jeder Funktion <img src="https://latex.codecogs.com/png.latex?L(x)"> mit einem Grenzwert <img src="https://latex.codecogs.com/png.latex?b%3E0"> ist <em>langsam variierend</em>.</li>
</ol>
<p><strong>Beweisskizze:</strong> Da <img src="https://latex.codecogs.com/png.latex?%5Clim%5Climits_%7Bx%20%5Cto%20+%5Cinfty%7D%20L(x)%20=%20b%20=%20%5Clim%5Climits_%7Bx%20%5Cto%20+%5Cinfty%7D%20L(t%5Ccdot%20x)"> ist <img src="https://latex.codecogs.com/png.latex?%5Clim%5Climits_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7BL(t%5Ccdot%20x)%7D%7BL(x)%7D%20=%20%5Cfrac%7B%5Clim%5Climits_%7Bx%20%5Cto%20+%5Cinfty%7D%20L(t%5Ccdot%20x)%7D%7B%5Clim%5Climits_%7Bx%20%5Cto%20+%5Cinfty%7D%20L(x)%7D%20=%20%5Cfrac%7Bb%7D%7Bb%7D%20=%201"></p>
<ol start="3" type="1">
<li>Für jedes reellwertige <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> ist <img src="https://latex.codecogs.com/png.latex?L(x)%20=%20log_%5Cbeta(x)"> <em>langsam variierend</em>.</li>
</ol>
<p><strong>Beweisskizze:</strong> Es gilt: - Für jede reelle Zahl <img src="https://latex.codecogs.com/png.latex?x%3E0"> ist <img src="https://latex.codecogs.com/png.latex?%5Clog_x(x)%20=%201">. - Für reelle Zahlen <img src="https://latex.codecogs.com/png.latex?a,%20b"> gilt: <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Blog(a)%7D%7B%5Clog(b)%7D%20=%20%5Clog_b(a)"> - Für reelle Zahlen <img src="https://latex.codecogs.com/png.latex?a,%20b"> gilt. <img src="https://latex.codecogs.com/png.latex?%5Clog(a%20%5Ccdot%20b)%20=%20log(a)%20+%20log(b)"> - Für jede Konstante <img src="https://latex.codecogs.com/png.latex?k"> gilt <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Clog_x%20(k)%20=%200"> Somit gilt <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Clog_%5Cbeta(k%20%5Ccdot%20x)%7D%7B%5Clog_%5Cbeta(x)%7D%20=%20%5Clog_x(k%5Ccdot%20x)%20=%20%5Clog_x(k)%20+%20%5Clog_x(x)%20=%20%5Clog_x(k)%20+1%20%5Cto%201"> wenn <img src="https://latex.codecogs.com/png.latex?x%20%5Cto%20+%5Cinfty"></p>
<ol start="4" type="1">
<li>Die Funktion <img src="https://latex.codecogs.com/png.latex?x%5E%5Cbeta"> ist für alle <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20%5Cneq%200"> <em><strong>nicht</strong> langsam variierend</em>. <strong>Beweisskizze:</strong> Für <img src="https://latex.codecogs.com/png.latex?t%20%5Cneq%201"> gilt: <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7B(tx)%5E%5Cbeta%7D%7Bx%5E%5Cbeta%7D%20=%20t%5E%5Cbeta%20%5Cneq%201"> Damit sind die Funktionen zwar (s.u.) <em>regulär variierend</em>, aber nicht <em>langsam variierend</em>.</li>
</ol>
<p>Eine <strong>regulär variierende</strong> Funktion <img src="https://latex.codecogs.com/png.latex?L:(0,+%5Cinfty)%20%5Cto%20(0,+%5Cinfty)"> ist eine Funktion für die der Term</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7BL(t%5Ccdot%20x)%7D%7BL(x)%7D%20=%20g(t)"></p>
<p>mit <img src="https://latex.codecogs.com/png.latex?g(t)"> für alle <img src="https://latex.codecogs.com/png.latex?t%3E0"> einen endlichen aber nicht verschwindenen Wert (m.a.W.: <img src="https://latex.codecogs.com/png.latex?g(t)%20%5Cneq%200">) hat .</p>
<p>Karamata hat die regulär variierenden Funktionen nun wie folgt charaterisiert:</p>
<section id="charakterisierungssatz-von-karamata" class="level3 theorem">
<h3 class="theorem anchored" data-anchor-id="charakterisierungssatz-von-karamata">Charakterisierungssatz von Karamata</h3>
<p>Jede <em>regulär variierende</em> Funktion <img src="https://latex.codecogs.com/png.latex?f:(0,+%5Cinfty)%20%5Cto%20(0,+%5Cinfty)"> ist von der Form</p>
<p><img src="https://latex.codecogs.com/png.latex?f(x)%20=%20x%5E%5Cbeta%20%5Ccdot%20L(x),"></p>
<p>wobei <img src="https://latex.codecogs.com/png.latex?%5Cbeta%20%5Cin%20%5Cmathbf%7BR%7D"> eine reelle Zahl und <img src="https://latex.codecogs.com/png.latex?L(x)"> eine <em>langsam variiernde</em> Funktion ist.</p>
<!-- ENDE THEOREM-->
<p>Eine Konsequenz aus dem <em>Charakterisierungssatz von Karamata</em> ist, das die Funktion <img src="https://latex.codecogs.com/png.latex?g(t)"> aus der Definition der <em>regulär variierenden</em> Funktionen notwendigerweise die Gestalt</p>
<p><img src="https://latex.codecogs.com/png.latex?g(t)%20=%20t%5E%5Crho,"></p>
<p>mit einem <img src="https://latex.codecogs.com/png.latex?%5Crho%20%5Cin%20%5Cmathbf%7BR%7D">, haben muss.</p>
<p>Dieser Wert <img src="https://latex.codecogs.com/png.latex?%5Crho"> wird <strong>Index der Variation</strong> (engl. <em>index of variation</em>) genannt.</p>
<p>Die Katamata Theorie ist eine Theorie “erster Ordnung” für reguläre Variation. Weiterführend gibt es mit der <a href="https://encyclopediaofmath.org/wiki/De_Haan_theory">de Haan Theorie</a> als Theorie “zweiter Ordnung”.</p>
<p><strong>Quellen:</strong></p>
<ul>
<li><p><a href="https://encyclopediaofmath.org/index.php?title=Karamata_theory&amp;direction=next&amp;oldid=25937">Encylopedia of Math</a></p></li>
<li><p><a href="https://archive.org/details/regularvariation0000bing">Bingham, N. H.; Goldie, C. M.; Teugels, J. L. (1987), Regular Variation, Encyclopedia of Mathematics and its Applications, 27, Cambridge: Cambridge University Press, ISBN 0-521-30787-2, MR 0898871, Zbl 0617.26001</a></p></li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p><img src="https://latex.codecogs.com/png.latex?L"> oder auch <img src="https://latex.codecogs.com/png.latex?l"> wird (angeblich) hier für den Begriff <em>lente</em> (serb. für <strong>faul</strong>) verwendet. Behäbig ist also doch nicht so falsch. ;-)↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-02-13-behaebige-funktionen-aka-slowly-varying-function/</guid>
  <pubDate>Fri, 12 Feb 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Ein paar Gedanken über potenzgesetzliche Verteilungen (power law distributions)</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/</link>
  <description><![CDATA[ 





<p>Eine Funktion <img src="https://latex.codecogs.com/png.latex?f(x)"> heißt <strong>potenzgesetzlich</strong>, falls</p>
<p><img src="https://latex.codecogs.com/png.latex?f(x)%20=%20C%20%5Ccdot%20x%5Ea"></p>
<p>gilt, für mindestens alle reellen <img src="https://latex.codecogs.com/png.latex?x%20%3E%20x_%7Bmin%7D">.</p>
<p>Gewöhnlich setzt man <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%20-a"> und schreibt</p>
<p><img src="https://latex.codecogs.com/png.latex?f(x)%20=%20C%20%5Ccdot%20x%5E%7B-%5Calpha%7D."></p>
<p>Damit ergibt sich für <img src="https://latex.codecogs.com/png.latex?f'(x)"> die Form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af'(x)%20=%20-C%20%5Ccdot%20%5Calpha%20%5Ccdot%20x%5E%7B-%5Calpha%20-1%7D%20=%20C%5E*%20%5Ccdot%20x%5E%7B-(%5Calpha%20+%201)%7D%0A"> mit <img src="https://latex.codecogs.com/png.latex?C%5E*%20=%20-C%20%5Ccdot%20%5Calpha">.</p>
<p>Eine <strong>(streng) potenzgesetzliche Verteilungen</strong> (engl. <strong>(strong) power-law probability distribution</strong>) zur ZV <img src="https://latex.codecogs.com/png.latex?X"> ist eine Verteilung deren Überlebensfunktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D_X(x)=P(X%20%3E%20x)"> die folgende Gestalt hat: <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(x)=P(X%20%3E%20x)%20=%20C%20%5Ccdot%20x%5E%7B-%5Calpha%7D"></p>
<p>Mit der Dichte <img src="https://latex.codecogs.com/png.latex?f_X"> ergibt sich: <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(x)=P(X%20%3E%20x)%20=%20C%20%5Ccdot%20x%5E%7B-%5Calpha%7D%20=%5Cint_x%5E%5Cinfty%20f_X(t)%20%5Ctext%7Bd%7Dt%20=%20C%5E*%20%5Ccdot%20%5Cint_x%5E%5Cinfty%20%20t%5E%7B-(%5Calpha+1)%7D%20%5Ctext%7Bd%7Dt%20=%20C%5E*%20%5Ccdot%20%5Cint_x%5E%5Cinfty%20t%5E%7B-%5Calpha%7D%20%5Ctext%7Bd%7Dt"></p>
<p>Anstelle der Konstanten <img src="https://latex.codecogs.com/png.latex?C"> tritt oft eine <strong>langsam variierende Funktion</strong> (engl. <strong>slowly varying funktion</strong>). Wir erhalten somit die folgende, allgemeinere Definition:</p>
<p>Eine <strong>potenzgesetzliche Verteilungen</strong> (engl. <strong>power-law probability distribution</strong>) (zu einer Zufallsvariable <img src="https://latex.codecogs.com/png.latex?X">) ist eine Verteilung deren Überlebensfunktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(x)=P(X%20%3E%20x)"> die folgende Gestalt hat:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(x)=P(X%20%3E%20x)%20=%20L(x)%20%5Ccdot%20x%5E%7B-%5Calpha%7D"></p>
<p>Dabei ist <img src="https://latex.codecogs.com/png.latex?L(x):(x_%7B%5Cmin%7D,%20+%5Cinfty)%20%5Cto%20(x_%7B%5Cmin%7D,%20+%5Cinfty)"> eine <em>langsam variierende Funktion</em>, also gilt für alle <img src="https://latex.codecogs.com/png.latex?t%3E0">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bx%20%5Cto%20+%5Cinfty%7D%20%5Cfrac%7BL(t%20%5Ccdot%20x)%7D%7BL(x)%7D%20=%201%0A"></p>
<p>Ist nun wieder <img src="https://latex.codecogs.com/png.latex?f_X"> die Dichte, so erhalten wir: <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(x)=P(X%20%3E%20x)%20=%20L(x)%20%5Ccdot%20x%5E%7B-%5Calpha%7D%20=%20%5Cint_x%5E%5Cinfty%20f_X(t)%20dt"></p>
<p><img src="https://latex.codecogs.com/png.latex?f'(x)%20=%20%5BL(x)x%5E%7B-%5Calpha%7D%5D'"> <img src="https://latex.codecogs.com/png.latex?%5Cint_x%5E%5Cinfty%20f_X(t)%20dt=%20%5Cint_x%5E%5Cinfty%20%5BL(t)t%5E%7B-%5Calpha%7D%5D'%20dt"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5CDelta%20x_0%20=%20h%20=%20x_1%20-%20x_0"> <img src="https://latex.codecogs.com/png.latex?x_1%20=%20x_0%20+%20%5CDelta%20x_0%20=%20x_0%20+%20h"> <img src="https://latex.codecogs.com/png.latex?x_1%20=%20c%20%5Ccdot%20x_0"> <img src="https://latex.codecogs.com/png.latex?x_0%20+%20h%20=%20c%20%5Ccdot%20x_0%20%3C=%3E%20c%20=%201%20+%20%5Cfrac%7Bh%7D%7Bx_0%7D"> <img src="https://latex.codecogs.com/png.latex?L(x_1)%20=%20L(x_0+h)%20=%20L(c%20%5Ccdot%20x_0)"> <img src="https://latex.codecogs.com/png.latex?L(x_1)%20-%20L(x_0)%20=%20L(c%20%5Ccdot%20x_0)%20-%20L(x_0)%20=%20L(x_0%20+%20h)%20-%20L(x_0)%7D"> $</p>
<p><strong>Fakten</strong>:</p>
<ul>
<li>Sinnvoll nur, wenn <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%3E%200">.</li>
<li>Ist <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%3C%203">, dann ist die <em>Varianz</em> und die <em>Schiefe</em> (engl. <em>skewness</em>) (mathematisch) nicht definiert.</li>
<li>Für <img src="https://latex.codecogs.com/png.latex?k%20%3E%20%5Calpha-1"> ist das k. Moment unendlich.</li>
</ul>
<p>Logarithmiert man <img src="https://latex.codecogs.com/png.latex?y=f(x)=C%20%5Ccdot%20x%5E%7B-%5Calpha%7D">, so erhält mensch:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clog(y)%20=%20%5Clog(C)%20-%5Calpha%20%5Ccdot%20%5Clog(x)"></p>
<p>Ist eine Verteilung potenzgesetzlich, dann kann man <img src="https://latex.codecogs.com/png.latex?%5Calpha">, wie folgt abschätzen:</p>
<p>Seien <img src="https://latex.codecogs.com/png.latex?x_0,%20x_1%20%3E%20x_%7Bmin%7D"> zwei reelle Zahlen, <img src="https://latex.codecogs.com/png.latex?y_0=f(x_0)"> bzw. <img src="https://latex.codecogs.com/png.latex?y_1%20=%20f(y_1)">.</p>
<p>Dann kann mensch wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%20%20%5Clog(y_1)%20-%20%5Clog(y_0)%20&amp;=%20%5Clog(C)%20-%20%5Calpha%20%5Ccdot%5Clog(x_1)%20-%20%5Clog(C)%20+%20%5Calpha%20%5Ccdot%20%5Clog(x_0)%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;=%20%5Calpha%20%5Ccdot%5Cleft(%5Clog(x_0)-%20%5Clog(x_1)%20%5Cright)%0A%5Cend%7Balign*%7D"></p>
<p>den Wert für <img src="https://latex.codecogs.com/png.latex?%5Calpha">, so kann man mittels</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%20%5Cfrac%7B%5Clog(y_1)%20-%20%5Clog(y_0)%7D%7B%5Clog(x_0)-%20%5Clog(x_1)%7D"></p>
<p>den Wert für <img src="https://latex.codecogs.com/png.latex?%5Calpha"> bestimmen.</p>
<p>Mit dem so ermittelten <img src="https://latex.codecogs.com/png.latex?%5Calpha">, können wir <img src="https://latex.codecogs.com/png.latex?C"> wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Clog(C)%20=%20%5Clog(y)+%20%5Calpha%5Clog(x)"></p>
<p>mit Hilfe von</p>
<p><img src="https://latex.codecogs.com/png.latex?C%20=%20y%20%5Ccdot%20x_0%5E%5Calpha%20=%20f(x_0)%20%5Ccdot%20x_0%5E%5Calpha"></p>
<p>für ein <img src="https://latex.codecogs.com/png.latex?x_0%20%3E%20x_%7Bmin%7D"> abschätzen.</p>
<p><strong>Beispiel</strong>:</p>
<p>Nehmen wir die t-Verteilung mit <img src="https://latex.codecogs.com/png.latex?n=2"> Freiheitsgeraden. Die Dichtefunktion bezeichnen wir mit <img src="https://latex.codecogs.com/png.latex?t_%7B2%7D(x)">.</p>
<p>Dann dann können wir <img src="https://latex.codecogs.com/png.latex?%5Calpha=3"> und <img src="https://latex.codecogs.com/png.latex?C=1"> abschätzen.</p>
<p>Schauen wir uns das einmal als Grafik an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(lower_bound, upper_bound, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb1-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb1-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb1-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-2-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hier eine doppelt-logarithmische Darstellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb2-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb2-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>( C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb2-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb2-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb2-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb2-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-3-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Noch ein Beispiel:</strong></p>
<p>Nehmen wir die t-Verteilung mit <img src="https://latex.codecogs.com/png.latex?n=1"> Freiheitsgeraden. Die Dichtefunktion bezeichnen wir mit <img src="https://latex.codecogs.com/png.latex?t_%7B1%7D(x)">.</p>
<p>Dann dann können wir <img src="https://latex.codecogs.com/png.latex?%5Calpha=2"> und <img src="https://latex.codecogs.com/png.latex?C=0.32"> abschätzen.</p>
<p>Schauen wir uns das einmal als Grafik an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(lower_bound, upper_bound, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb3-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb3-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb3-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-5-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hier eine doppelt-logarithmische Darstellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">df =</span> dfree, </span>
<span id="cb4-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb4-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>( C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb4-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb4-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb4-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb4-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-6-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Ein ’Gegen-’Beispiel:</strong></p>
<p>Betrachten wir nun die (rechte Seite – <img src="https://latex.codecogs.com/png.latex?x%3E1=x_%7Bmin%7D">) einer Gauß’schen Standardnormalverteilung.</p>
<p>Mit den Stützstellen <img src="https://latex.codecogs.com/png.latex?x_0%20=%201"> und <img src="https://latex.codecogs.com/png.latex?x_1%20=%205"> können wir <img src="https://latex.codecogs.com/png.latex?%5Calpha=7.46"> und <img src="https://latex.codecogs.com/png.latex?C=0.24"> abschätzen. Schauen wir uns das einmal als Grafik an:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb5-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(lower_bound, upper_bound, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>,</span>
<span id="cb5-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb5-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>(C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb5-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-8-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hier eine doppelt-logarithmische Darstellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, </span>
<span id="cb6-2">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb6-3">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_line</span>( C<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>alpha) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> x, </span>
<span id="cb6-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb6-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb6-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb6-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-9-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Wir erkennen, dass hier etwas nicht passt. Die Standardnormalverteilung ist (vielleicht) keine <em>potenzgesetzich</em> Verteilung?</p>
<p>Ein oft verwendetes Kriterium ist, dass sich die Funktion in der doppelt-logarithmischen Darstellung als Gerade offenbart.</p>
<p>Schauen wir daher einmal nach:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">lower_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-2">upper_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_dist</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"norm"</span>, </span>
<span id="cb7-5">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(lower_bound, upper_bound), </span>
<span id="cb7-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_refine</span>(</span>
<span id="cb7-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_log10</span>(),</span>
<span id="cb7-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_log10</span>()</span>
<span id="cb7-10">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/index_files/figure-html/unnamed-chunk-10-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>** — **</p>
<p>Weiter gilt für <em>potenzgesetzliche Verteilungen</em> wegen</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bf(x)%7D%7Bf(c%5Ccdot%20x)%7D%20=%20%5Cfrac%7BC%20%5Ccdot%20x%5E%7B-%5Calpha%7D%7D%7BC%20%5Ccdot%20(c%5Ccdot%20x)%5E%7B-%5Calpha%7D%7D%0A=%20c%5E%5Calpha"></p>
<p><img src="https://latex.codecogs.com/png.latex?f(x)"> und <img src="https://latex.codecogs.com/png.latex?f(c%5Ccdot%20x)"> für alle (beliebig aber festen) <img src="https://latex.codecogs.com/png.latex?c%3E0"> <em>proportional</em>, was man gerne als <img src="https://latex.codecogs.com/png.latex?f(x)%20%5Cpropto%20f(c%20%5Ccdot%20x)"> schreibt.</p>
<p>** — **</p>
<p>Die Wahrscheinlichkeit für ein (mindestens) <img src="https://latex.codecogs.com/png.latex?8-%5Csigma"> Ereignis liegt bei einer Standardnormalverteilung bei etwa <img src="https://latex.codecogs.com/png.latex?6.66133814775094%5Ctimes%2010%5E%7B-16%7D">.</p>
<p>Bei einer t-Verteilung mit 2 Freiheitsgeraden bei etwa 0.00763403608266899$.</p>
<p>Während die Eintrittschance eines (mindestens) <img src="https://latex.codecogs.com/png.latex?8-%5Csigma"> Ereignisses bei der Standardnormalverteilung bei etwa <img src="https://latex.codecogs.com/png.latex?1%20:%20round(1/(1-pnorm(8)),0)"> liegt, ist diese der t-Verteilung mit einem Freiheitsgrad bei etwa $1 : 131</p>



 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-02-12-ein-paar-gedanken-ueber-potenzgesetzliche-verteilungen-power-law-distributions/</guid>
  <pubDate>Thu, 11 Feb 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Gedankenstütze zu wichtigen Funktionsbegriffen in der Statistik</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2021-02-12-gedankenstütze-zu-wichtigen-funktionsbegriffen-in-der-statistik/</link>
  <description><![CDATA[ 





<section id="eine-kleine-liste-von-fundermentalen-begriffen-in-der-statistik." class="level1">
<h1>Eine kleine Liste von fundermentalen Begriffen in der Statistik.</h1>
<p>Gilt für eine reelle Funktion <img src="https://latex.codecogs.com/png.latex?f:%20%5Cmathbf%7BR%7D%20%5Cto%20%5Cmathbf%7BR%7D">:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?f(x)"> ist <em>nichtnegativ</em>, d.h., <img src="https://latex.codecogs.com/png.latex?f(x)%20%5Cgeq%200">, für alle <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathbf%7BR%7D">.</li>
<li><img src="https://latex.codecogs.com/png.latex?f(x)"> ist <em>integrierbar</em>.</li>
<li><img src="https://latex.codecogs.com/png.latex?f(x)"> ist <em>normiert</em> in dem Sinne, dass <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20f(x)%20%5C,%5Ctext%7Bd%7Dx%20=%201"></li>
</ul>
<p>Dann nennen wir <img src="https://latex.codecogs.com/png.latex?f(x)"> eine <strong>Wahrscheinlichkeitsdichtefunktion</strong> (engl. <strong>probability density funktion</strong> kurz <strong>pdf</strong>) oder kurz <strong>Dichte</strong> (engl. <strong>density</strong>).</p>
<p>Durch <img src="https://latex.codecogs.com/png.latex?P(%5Ba,%20b%5D)%20:=%20%5Cint_a%5Eb%20f(x)%20%5Ctext%7Bd%7D%20x"> definiert <img src="https://latex.codecogs.com/png.latex?f"> eine <em>Wahrscheinlichkeitsverteilung</em> auf den reellen Zahlen.</p>
<p>Ist <img src="https://latex.codecogs.com/png.latex?X"> eine reelwertige <em>Zufallsvariable</em> (kurz <strong>ZV</strong>) und existiert eine reelle Funktion <img src="https://latex.codecogs.com/png.latex?f_X(x)"> der Art, dass für alle <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5Cmathbf%7BR%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P(X%20%5Cleq%20a)%20=%20%5Cint_%7B-%5Cinfty%7D%5Ea%20f_X(x)%20%5Ctext%7Bd%7Dx"></p>
<p>gilt, so nennt man <img src="https://latex.codecogs.com/png.latex?f"> die <strong>Wahrscheinlichkeitsdichtefunktion von</strong> <img src="https://latex.codecogs.com/png.latex?X">.</p>
<p>Die Funktion</p>
<p><img src="https://latex.codecogs.com/png.latex?F_X(a)%20=%20P(X%20%5Cleq%20a)"></p>
<p>nenen wir <strong>(Wahrscheinlichkeits-)Verteilung(-sfunktion)</strong> (engl. <strong>cumulative distribution function</strong> kurz <strong>cdf</strong> aber auch nur <strong>distribution function</strong>) <strong>von</strong> <img src="https://latex.codecogs.com/png.latex?X">.</p>
<p>Genau dann ist eine Funktion <img src="https://latex.codecogs.com/png.latex?F:%20%5Cmathbf%7BR%7D%20%5Cto%20%5B0,%201%5D"> eine <strong>Verteilungsfunktion</strong>, wenngilt:</p>
<ul>
<li>Es ist <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bt%20%5Cto%20-%5Cinfty%7D%20F(t)=0"> und <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bt%20%5Cto%20+%5Cinfty%7D%20F(t)=1"></li>
<li>Die Funktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(t)"> ist <strong>monoton wachsend</strong>.</li>
<li>Die Funktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(t)"> ist <strong>rechtsseitig stetig</strong></li>
</ul>
<p>Die Funktion</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D_X(a)%20=%201%20-%20F_X(a)"></p>
<p>nennen wir <strong>Überlebensfunktion</strong> (engl. <strong>survival function</strong>, <strong>complementarey cumulative distribution funktion</strong> kurz <strong>ccdf</strong>, <strong>tail distribution</strong>, <strong>exceedance</strong> oder <strong>reliability function</strong>).</p>
<p>Es gilt <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D_X(a)%20+%20F_X(a)%20=%201">.</p>
<p>Genau dann ist eine Funktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D:%20%5Cmathbf%7BR%7D%20%5Cto%20%5B0,%201%5D"> eine <strong>Überlebensfunktion</strong>, wenn gilt:</p>
<ul>
<li>Es ist <img src="https://latex.codecogs.com/png.latex?%5Clim_%5Climits%7Bt%20%5Cto%20-%5Cinfty%7D%20%5Coverline%7BF%7D(t)=1"> und <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bt%20%5Cto%20+%20%5Cinfty%7D%5Coverline%7BF%7D(t)=0"></li>
<li>Die Funktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(t)"> ist <strong>monoton fallend</strong>.</li>
<li>Die Funktion <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D(t)"> ist <strong>rechtsseitig stetig</strong></li>
</ul>
<p>Ein paar weitere Eigenschaften von <em>Überlebensfunktionen</em>:</p>
<ul>
<li>Nicht-negative stetige ZV <img src="https://latex.codecogs.com/png.latex?X"> mit Erwartungswert, also <img src="https://latex.codecogs.com/png.latex?%5Cint_0%5E%5Cinfty%20x%20f(x)%20%5Ctext%7Bd%7D%20x%20=%20%5Cmu%20%3C%20%5Cinfty">, erfüllen die <a href="https://de.wikipedia.org/wiki/Markow-Ungleichung_(Stochastik)">Markov-Ungleichung</a></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D_X(x)%20%5Cleq%20%5Cfrac%7B%5Coperatorname%7BE%7D(X)%7D%7Bx%7D"></p>
<ul>
<li>Ist <img src="https://latex.codecogs.com/png.latex?X"> eine ZV und <img src="https://latex.codecogs.com/png.latex?%5Coverline%7BF%7D_X"> die zugehörige Überlebensfunktion. Existiert <img src="https://latex.codecogs.com/png.latex?E(X)">, dann gilt <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bt%20%5Cto%20+%5Cinfty%7D%5Coverline%7BF%7D(x)=0%20=%20o%5Cleft(%5Cfrac%7B1%7D%7Bx%7D%5Cright)">.</li>
</ul>
<p><strong>Beweisskizze:</strong> Sei <img src="https://latex.codecogs.com/png.latex?f_X"> die Dichtefunktion von <img src="https://latex.codecogs.com/png.latex?F_X"> zur ZV <img src="https://latex.codecogs.com/png.latex?X">. Für jedes <img src="https://latex.codecogs.com/png.latex?c%3E0"> ist dann <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20%20%20E(X)%20=%20%5Cint_0%5E%5Cinfty%20x%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20&amp;=%20%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20+%5Cint_c%5E%5Cinfty%20x%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20%5C%5C%0A%20%20%20%20%20%20&amp;%5Cgeq%20%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20+%5Cint_c%5E%5Cinfty%20c%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20%5C%5C%0A%20%20%20%20%20%20&amp;=%20%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20+%20c%20%5Ccdot%20%5Cint_c%5E%5Cinfty%20f_X(x)%20%5Ctext%7Bd%7Dx%20%5C%5C%0A%20%20%20%20%20%20&amp;=%20%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20+c%20%5Ccdot%20%5Coverline%7BF%7D(c)%0A%20%20%5Cend%7Baligned%7D%0A"></p>
<p>Damit gilt nun: <img src="https://latex.codecogs.com/png.latex?%0A0%20%5Cleq%20c%20%5Ccdot%20%5Coverline%7BF%7D(c)%20%5Cleq%20E(X)%20-%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%0A"> Wegen <img src="https://latex.codecogs.com/png.latex?%5Clim%5Climits_%7Bc%20%5Cto%20+%5Cinfty%7D%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%20=%20E(X)"> folgt:</p>
<p><img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20c%20%5Ccdot%20%5Coverline%7BF%7D(c)%20%5Cleq%20E(X)%20-%20%5Cint_0%5Ecx%20%5Ccdot%20f_X(x)%20%5Ctext%7Bd%7Dx%5Cto%200%20%5Ctext%7B%20wenn%20%7D%20c%20%5Cto%20%5Cinfty%0A"></p>
<p>Für nicht-negative ZV <img src="https://latex.codecogs.com/png.latex?X"> gilt:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AE(X)%20=%20%5Cint_0%5E%5Cinfty%20%5Coverline%7BF%7D_X(x)%20%5C,%5Ctext%7Bd%7D%20x%0A"></p>


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2021-02-12-gedankenstütze-zu-wichtigen-funktionsbegriffen-in-der-statistik/</guid>
  <pubDate>Thu, 11 Feb 2021 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Cook Abstand</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2020-06-29-cook-abstand/</link>
  <description><![CDATA[ 





<p><strong>Frage: Was macht einen Wert zum Ausreißer?</strong></p>
<p>Eine mögliche Antwort lautet: <em>Ein Wert gilt als Ausreißer, wenn er deutlich von den übrigen Werten abweicht <strong>und</strong> einen (starken) Einfluss auf das Modell ausübt.</em></p>
<p>Ein Verfahren zur Identifikation solcher Ausreißer ist der <strong>Cook-Abstand</strong> (engl.: <strong>Cook’s distance</strong>). Die zugrunde liegende Idee besteht darin zu messen, wie stark ein einzelner Wert das Modell beeinflusst. Dazu vergleicht man das Modell einmal mit und einmal ohne diesen Wert.</p>
<p>Sehen wir uns den Cook-Abstand anhand eines einfachen linearen Regressionsmodells näher an:</p>
<section id="vorbereitungen" class="level3">
<h3 class="anchored" data-anchor-id="vorbereitungen">Vorbereitungen</h3>
<p>Wir nutzen das Paket <code>mosaic</code>, daher laden wir es zunächst:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span></code></pre></div>
</div>
<p>Falls die <strong>tipping</strong>-Daten nicht lokal vorliegen, werden sie aus dem Internet geladen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tips.csv"</span>)) {</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://goo.gl/whKjnl"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tips.csv"</span>)</span>
<span id="cb2-3">}</span></code></pre></div>
</div>
<p>Nun werden die Daten eingelesen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">tips <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv2</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tips.csv"</span>)</span></code></pre></div>
</div>
<p>Für unser Modell verwenden wir nur die Variablen <code>total_bill</code> und <code>tip</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">tips <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total_bill"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tip"</span>)) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> tips</span></code></pre></div>
</div>
</section>
<section id="unser-modell" class="level2">
<h2 class="anchored" data-anchor-id="unser-modell">Unser Modell:</h2>
<p>Zuerst ein Streudiagramm zur Visualisierung der Daten:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2020-06-29-cook-abstand/index_files/figure-html/unnamed-chunk-2-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Dann erstellen wir ein lineares Regressionsmodell:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">erg_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(erg_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tip ~ total_bill, data = tips)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1982 -0.5652 -0.0974  0.4863  3.7434 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.920270   0.159735   5.761 2.53e-08 ***
total_bill  0.105025   0.007365  14.260  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.022 on 242 degrees of freedom
Multiple R-squared:  0.4566,    Adjusted R-squared:  0.4544 
F-statistic: 203.4 on 1 and 242 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Visualisierung der Regressionsgeraden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> erg_lm,</span>
<span id="cb8-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressionsgerade"</span>,</span>
<span id="cb8-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb8-6">  ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2020-06-29-cook-abstand/index_files/figure-html/unnamed-chunk-4-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Einflussreiche Ausreißer können bei linearen Modellen problematisch sein. Was passiert, wenn wir einen potenziellen Ausreißer entfernen?</p>
<p>Beispiel: Wir eliminieren die Beobachtung mit dem Index 173</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">tips <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">173</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> tips_removed</span>
<span id="cb9-2">tips_removed</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  total_bill  tip
1       7.25 5.15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">tips <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">173</span>) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> tips_red</span>
<span id="cb11-2">erg_lm_red <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips_red)</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(erg_lm_red)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tip ~ total_bill, data = tips_red)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2136 -0.5351 -0.0818  0.4951  3.6869 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.86065    0.15709   5.479 1.08e-07 ***
total_bill   0.10731    0.00723  14.843  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9992 on 241 degrees of freedom
Multiple R-squared:  0.4776,    Adjusted R-squared:  0.4754 
F-statistic: 220.3 on 1 and 241 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Grafischer Vergleich:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips_red) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(</span>
<span id="cb13-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> erg_lm,</span>
<span id="cb13-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressionsgerade"</span></span>
<span id="cb13-5">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(</span>
<span id="cb13-7">    tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, </span>
<span id="cb13-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Entfernter Punkt"</span>,</span>
<span id="cb13-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips_removed)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2020-06-29-cook-abstand/index_files/figure-html/unnamed-chunk-7-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="berechnung-des-cook-abstands" class="level2">
<h2 class="anchored" data-anchor-id="berechnung-des-cook-abstands">Berechnung des Cook-Abstands</h2>
<p>Wir vergleichen die Prognosen beider Modelle:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">new_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_bill =</span> tips<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>total_bill)</span>
<span id="cb14-2">prognose_lm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(erg_lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> new_data)</span>
<span id="cb14-3">prognose_lm_red <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(erg_lm_red, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> new_data)</span></code></pre></div>
</div>
<p>Berechnung:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad_j%20=%20%5Csum_%7Bi=1%7D%5En%20%5Cleft(%5Chat%7By%7D_i%20-%20%5Chat%7By%7D_%7Bi(j)%7D%5Cright)%5E2%0A"> Dabei ist <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_i"> die Prognose des Wertes <img src="https://latex.codecogs.com/png.latex?y_i"> auf Basis von <img src="https://latex.codecogs.com/png.latex?x_i"> mit dem Originalmodell und <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_%7Bi(j)%7D"> die Prognose wenn man die <img src="https://latex.codecogs.com/png.latex?j">-te Beobachtung aus dem Modell gestrichen hat.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">d_j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>((prognose_lm <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> prognose_lm_red)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-2">d_j</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1511406</code></pre>
</div>
</div>
<p>Der Cook Abstand <img src="https://latex.codecogs.com/png.latex?D_j"> wird nun noch <em>normiert</em> durch <img src="https://latex.codecogs.com/png.latex?%7B%5Ctext%7Bvar%7D_%7B%5Ctext%7Bcook%7D%7D%7D%20=%20p%20%5Ccdot%20s_%7B%5Cepsilon_i%5E2%7D%5E2"> Dabei ist <img src="https://latex.codecogs.com/png.latex?s_%7B%5Cepsilon_i%5E2%7D%5E2"> der erwartungstreue Schätzer der Varianz der Residuen und <img src="https://latex.codecogs.com/png.latex?p"> die Anzahl aller erklärenden Variablen plus Eins, also: $ 1 + 1 = 2$.</p>
<p>Normierung des Cook-Abstands:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20D_j%20=%20%5Cfrac%7Bd_j%7D%7B%5Ctext%7Bvar%7D_%7B%5Ctext%7Bcook%7D%7D%7D%20=%20%5Cfrac%7B%5Csum%5Climits_%7Bi=1%7D%5En%20%5Cleft(%5Chat%7By%7D_i%20-%20%5Chat%7By%7D_%7Bi(j)%7D%5Cright)%5E2%7D%7Bp%20%5Ccdot%20s_%7B%5Cepsilon_i%5E2%7D%5E2%7D%0A"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary des Modells</span></span>
<span id="cb17-2">selm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(erg_lm)</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir finden p als rank im Modell</span></span>
<span id="cb17-5">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> erg_lm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rank </span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Wir finden den erwatungtreuen Schätzer im Summary des Modells</span></span>
<span id="cb17-8">s_quad_eps_quad <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (selm<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>sigma)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> </span>
<span id="cb17-9"></span>
<span id="cb17-10">var_cook <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> p <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s_quad_eps_quad</span>
<span id="cb17-11"></span>
<span id="cb17-12">D_j <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> d_j <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> var_cook</span>
<span id="cb17-13">D_j</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07234504</code></pre>
</div>
</div>
<p>Alternativ kann der Wert direkt mit cooks.distance() berechnet werden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cooks.distance</span>(erg_lm)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">173</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       173 
0.07234504 </code></pre>
</div>
</div>
<p>Wann aber ist nun ein Wert ein <em>einflussreicher</em> Ausreißer?</p>
</section>
<section id="entscheidungskriterien" class="level2">
<h2 class="anchored" data-anchor-id="entscheidungskriterien">Entscheidungskriterien</h2>
<p>Cook selber gibt dafür die Bedingung <img src="https://latex.codecogs.com/png.latex?D_j%20%3E%201"> an. Andere Autor*innen schreiben <img src="https://latex.codecogs.com/png.latex?D_j%20%3E%204/n">, wobei <img src="https://latex.codecogs.com/png.latex?n"> die Anzahl der Beobachtung ist.</p>
<p>In unserem Beispiel liefert die Variante <img src="https://latex.codecogs.com/png.latex?D_j%20%3E%201"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">cooks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cooks.distance</span>(erg_lm)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(cooks) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb21-3">n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(tips)</span>
<span id="cb21-4"></span>
<span id="cb21-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(cooks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>keinen Ausreißer.</p>
<p>Wenn wir jedoch mit <img src="https://latex.codecogs.com/png.latex?D_j%20%3E%204/n"> suchen .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(cooks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>dann gibt es Ausreißer.</p>
<p>Die Indices dieser finden wir mit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(cooks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  24  48  57 103 142 157 171 173 179 183 184 185 188 208 211 213 215 238</code></pre>
</div>
</div>
<p>Daten bereinigen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">remove <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(cooks <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n)</span>
<span id="cb27-2">tips <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>remove) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> tips_no_outliers</span>
<span id="cb27-3">tips <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(remove) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-&gt;</span> tips_removed</span>
<span id="cb27-4">erg_lm_no_outliers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips_no_outliers)</span></code></pre></div>
</div>
<p>Ergebnis des Modells:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(erg_lm_no_outliers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = tip ~ total_bill, data = tips_no_outliers)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.22592 -0.48166 -0.06794  0.46992  2.31414 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.773324   0.139435   5.546  8.2e-08 ***
total_bill  0.111799   0.006958  16.069  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7778 on 224 degrees of freedom
Multiple R-squared:  0.5355,    Adjusted R-squared:  0.5334 
F-statistic: 258.2 on 1 and 224 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Daten bereinigen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> erg_lm_no_outliers) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(</span>
<span id="cb30-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> erg_lm_no_outliers, </span>
<span id="cb30-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressionsgerade"</span></span>
<span id="cb30-5">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2020-06-29-cook-abstand/index_files/figure-html/unnamed-chunk-16-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Grafischer Vergleich beider Modelle:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> erg_lm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(</span>
<span id="cb31-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span>  erg_lm,</span>
<span id="cb31-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressionsgerade (Orginal)"</span></span>
<span id="cb31-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_coefline</span>(</span>
<span id="cb31-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> erg_lm_no_outliers,</span>
<span id="cb31-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Regressionsgerade (No Outliers)"</span></span>
<span id="cb31-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gf_point</span>(</span>
<span id="cb31-11">    tip <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> total_bill,</span>
<span id="cb31-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Entfernte Punkte"</span>,</span>
<span id="cb31-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> tips_removed</span>
<span id="cb31-14">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2020-06-29-cook-abstand/index_files/figure-html/unnamed-chunk-17-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelle-in-gleichungsform" class="level2">
<h2 class="anchored" data-anchor-id="modelle-in-gleichungsform">Modelle in Gleichungsform</h2>
<p>Das ursprüngliche Modell:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Cwidehat%7Btips%7D_%7Blm%7D%20=%200.9202696%20+%200.1050245%20%5Ccdot%20total%5C_bill%0A"></p>
<p>Das um pot. Ausreißer bereinigte Modell:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%20%20%5Cwidehat%7Btips%7D_%7Blm%5C_no%7D%200.7733236%20+%200.1117985%20%5Ccdot%20total%5C_bill%0A"></p>


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2020-06-29-cook-abstand/</guid>
  <pubDate>Sun, 28 Jun 2020 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Der Zentrale Grenzwertsatz</title>
  <dc:creator>Norman Markgraf</dc:creator>
  <link>https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/</link>
  <description><![CDATA[ 





<section id="der-zentrale-grenzwertsatz-der-statistik-bei-identischer-verteilung." class="level2">
<h2 class="anchored" data-anchor-id="der-zentrale-grenzwertsatz-der-statistik-bei-identischer-verteilung.">Der <strong>Zentrale Grenzwertsatz</strong> der Statistik bei identischer Verteilung.</h2>
<section id="zentraler-grenzwertsatz" class="level3">
<h3 class="anchored" data-anchor-id="zentraler-grenzwertsatz">Zentraler Grenzwertsatz</h3>
<p>Seien <img src="https://latex.codecogs.com/png.latex?X_1,%20X_2,%20...,%20X_n"> unabhängige und identisch verteilte Zufallsvariablen mit bekanntem Erwartungswert <img src="https://latex.codecogs.com/png.latex?E(X_i)%20=%20%5Cmu"> und bekannter Varianz <img src="https://latex.codecogs.com/png.latex?Var(X_i)=%5Csigma%5E2">.</p>
<p>Für die Summe <img src="https://latex.codecogs.com/png.latex?S_n%20=%20%5Csum_%7Bi=1%7D%5En%20X_i"> ist dann der Erwartungswert <img src="https://latex.codecogs.com/png.latex?E(S_n)=%20n%20%5Ccdot%20%5Cmu"> und die Varianz <img src="https://latex.codecogs.com/png.latex?Var(S_n)=%20n%20%5Ccdot%20%5Csigma%5E2">.</p>
<p>Dann gilt für die <em>standardisierte</em> Zufallsvariable</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AZ_n%20&amp;=%20%5Cfrac%7B%5Cleft(%5Csum%5Climits_%7Bi=1%7D%5En%20X_i%5Cright)%20-%20n%20%5Ccdot%20%5Cmu%7D%7B%5Csqrt%7Bn%5Ccdot%20%5Csigma%5E2%7D%7D%0A%20%20%20%20=%20%5Cfrac%7BS_n%20-%20n%20%5Ccdot%20%5Cmu%7D%7B%5Csigma%20%5Ccdot%20%5Csqrt%7Bn%7D%7D%0A%20%20%20%20=%20%5Cfrac%7Bn%20%5Ccdot%20%5Cbar%7BX%7D_n-n%20%5Ccdot%20%5Cmu%7D%7B%5Csigma%20%5Ccdot%20n%20/%20%5Csqrt%7Bn%7D%7D%20%5C%5C%0A%20%20%20%20&amp;=%20%5Cfrac%7B%5Cbar%7BX%7D_n%20-%20%5Cmu%7D%7B%5Csigma%20/%20%5Csqrt%7Bn%7D%7D%0A%20%20%20%20=%20%5Cfrac%7B%5Cbar%7BX%7D_n%20-%20%5Cmu%7D%7B%5Csigma%7D%20%5Ccdot%20%5Csqrt%7Bn%7D,%0A%5Cend%7Balign*%7D%0A"></p>
<p>dass sie für wachsendes <img src="https://latex.codecogs.com/png.latex?n"> immer besser durch die <em>Standardnormalverteilung</em> <img src="https://latex.codecogs.com/png.latex?N(0,%201)"> approximiert werden kann.</p>
<p>Mit anderen Worten:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(Z_n%20%5Cleq%20x)%20%5Clongrightarrow%20%5CPhi(x),%20%5Cquad%20%5Ctext%7B%20f%C3%BCr%20%7D%5C;%20n%20%5Crightarrow%20%5Cinfty%0A"></p>
</section>
</section>
<section id="ein-beispiel" class="level2">
<h2 class="anchored" data-anchor-id="ein-beispiel">Ein Beispiel:</h2>
<p>Nehmen wir drei Verteilungen mit Zufallsvariable <img src="https://latex.codecogs.com/png.latex?U">, <img src="https://latex.codecogs.com/png.latex?X">, <img src="https://latex.codecogs.com/png.latex?Y"> und jeweils <img src="https://latex.codecogs.com/png.latex?n"> Realisationen <img src="https://latex.codecogs.com/png.latex?u_1,%5Cdots,%20u_n">, <img src="https://latex.codecogs.com/png.latex?x_1,%5Cdots,%20x_n">, <img src="https://latex.codecogs.com/png.latex?y_1,%5Cdots,%20y_n">.</p>
<p>Wählen wir zunächst <img src="https://latex.codecogs.com/png.latex?n=5">:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">u</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.726 69.683 60.790  0.955 42.901</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">x</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7.942 15.905 12.917  6.818  4.434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">y</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.961 56.552 51.094 75.288 47.985</code></pre>
</div>
</div>
<p>Standardisieren wir die Werte:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(mosaic)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(u)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6695256  1.0830283  0.7710507 -1.3280357  0.1434823</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.3543069  1.3440714  0.7067796 -0.5940379 -1.1025063</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zscore</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.1677971 -0.1526624 -0.6657361  1.6085958 -0.9579944</code></pre>
</div>
</div>
<p>Die Behauptung des Zentralengrenzwertsatzes ist nun, dass mit steigender Anzahl an Werten <img src="https://latex.codecogs.com/png.latex?n"> die standardisierten Werte in der empirischen Verteilungsfunktion sich immer mehr der Verteilungsfunktion der Standardnormalverteilung annähern:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/index_files/figure-html/unnamed-chunk-4-1.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/index_files/figure-html/unnamed-chunk-4-2.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/index_files/figure-html/unnamed-chunk-4-3.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/index_files/figure-html/unnamed-chunk-4-4.webp" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Weiterführende Literatur und Quellen dieses Eintrags:</strong></p>


</section>

 ]]></description>
  <category>Statistik</category>
  <guid>https://www.sefiroth.de/posts/2017-04-05-der-zentrale-grenzwertsatz/</guid>
  <pubDate>Tue, 04 Apr 2017 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
